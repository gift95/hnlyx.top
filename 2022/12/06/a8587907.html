<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>MyBatis学习 | Yxliu's Blog</title><meta name="author" content="Yxliu"><meta name="copyright" content="Yxliu"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="mybatis映射文件配置1、传入的参数【1】parameterTypeCRUD标签都有一个属性parameterType，底层的statement通过它指定接收的参数类型。入参数据有以下几种类型：HashMap，基本数据类型（包装类），实体类；  1设置传入这条语句的参数类的完全限定名或别名。这个"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://www.hnlyx.top/2022/12/06/a8587907"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'MyBatis学习',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-03-30 09:35:04'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/gift95/gift95.github.io@master/themes/butterfly/source/css/tags.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/gift95/gift95.github.io@master/themes/butterfly/source/css/index.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/gift95/gift95.github.io@master/themes/butterfly/source/css/heartbeat.min.css"><script  src="https://cdn.jsdelivr.net/gh/gift95/gift95.github.io@master/themes/butterfly/source/js/jquery-3.6.0.min.js"></script><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/gift95/hexo-filter-gitcalendar@main/gitcalendar.css" media="print" onload="this.media='all'"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="Yxliu's Blog" type="application/atom+xml">
</head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">15</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">11</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">2</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/Love-and-Story/"><i class="fa-fw fa-solid fa-heart-circle-bolt"></i><span> 我们的故事</span></a></div><div class="menus_item"><a class="site-page" href="/Travel/"><i class="fa-fw fas fa-map-marked"></i><span> 旅行日记</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa  fa-binoculars"></i><span> 关于笔者</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://api.ixiaowai.cn/gqapi/gqapi.php')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Yxliu's Blog</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/Love-and-Story/"><i class="fa-fw fa-solid fa-heart-circle-bolt"></i><span> 我们的故事</span></a></div><div class="menus_item"><a class="site-page" href="/Travel/"><i class="fa-fw fas fa-map-marked"></i><span> 旅行日记</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa  fa-binoculars"></i><span> 关于笔者</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">MyBatis学习</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-12-06T10:52:12.000Z" title="发表于 2022-12-06 18:52:12">2022-12-06</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-03-30T01:35:04.617Z" title="更新于 2023-03-30 09:35:04">2023-03-30</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">12.7k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>50分钟</span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="mybatis映射文件配置"><a href="#mybatis映射文件配置" class="headerlink" title="mybatis映射文件配置"></a>mybatis映射文件配置</h1><h2 id="1、传入的参数"><a href="#1、传入的参数" class="headerlink" title="1、传入的参数"></a>1、传入的参数</h2><h3 id="【1】parameterType"><a href="#【1】parameterType" class="headerlink" title="【1】parameterType"></a>【1】parameterType</h3><pre><code>CRUD标签都有一个属性parameterType，底层的statement通过它指定接收的参数类型。入参数据有以下几种类型：HashMap，基本数据类型（包装类），实体类；
</code></pre>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">设置传入这条语句的参数类的完全限定名或别名。这个属性是可选的，因为 MyBatis 可以通过类型处理器（TypeHandler） 推断出具体传入语句的参数类型。</span><br></pre></td></tr></table></figure>



<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://js.hnlyx.top/img/1564474377224-164197976098210.png" alt="1564474377224"></p>
<p>说明：</p>
<p><strong>在mybatis中入参的数据类型分为2种：</strong></p>
<ol>
<li><p>简单数据类型：int,string,long,Date;</p>
</li>
<li><p>复杂数据类型：类(JavaBean)和Map;</p>
<p> 说明：如果传递参数是数组或者集合，底层都会封装到Map集合中。</p>
</li>
</ol>
<p>【示例】</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserMapper</span> &#123;</span><br><span class="line">    <span class="comment">//根据id查询</span></span><br><span class="line">    User <span class="title function_">queryById</span><span class="params">(Integer id)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">【基本类型数据】</span><br><span class="line"><span class="comment">&lt;!--根据id查询--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--parameterType=&quot;int&quot; 表示sql语句参数id的类型，int是Integer的别名.MyBatis 可以通过类型处理器（TypeHandler） 根据接口中的方法User queryById(Integer id)参数类型推断出具体传入语句的参数类型。--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;queryById&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;user&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span>&gt;</span></span><br><span class="line">    select * from user where id = #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line">【pojo类型】</span><br><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;savetUser&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">  INSERT INTO user(...)</span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>说明：对于parameterType属性可以不书写，那么MyBatis 就会通过类型处理器（TypeHandler） 根据接口中的方法User queryById(Integer id)参数类型推断出具体传入语句的参数类型。</p>
<h3 id="【2】自增主键回填（了解）"><a href="#【2】自增主键回填（了解）" class="headerlink" title="【2】自增主键回填（了解）"></a>【2】自增主键回填（了解）</h3><p>【需求】</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">新增一条数据成功后，将这条数据的主键封装到实体类中，并查看主键的值。</span><br></pre></td></tr></table></figure>

<p>【实现】</p>
<p>测试类代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">saveUser</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">    user.setUsername(<span class="string">&quot;蔡徐坤&quot;</span>);</span><br><span class="line">    user.setBirthday(<span class="keyword">new</span> <span class="title class_">Date</span>());</span><br><span class="line">    user.setSex(<span class="string">&quot;男&quot;</span>);</span><br><span class="line">    user.setAddress(<span class="string">&quot;上海&quot;</span>);</span><br><span class="line"></span><br><span class="line">    userMapper.saveUser(user);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//查看新的数据的主键值</span></span><br><span class="line">    System.out.println(user.getId());<span class="comment">//null</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>直接获取的结果是null。</p>
<p>有两种方式可以实现添加好数据直接将主键封装到实体类对象中，如下：</p>
<h4 id="实现一：使用insert标签的子标签selectKey实现；-自学，了解，使用不多"><a href="#实现一：使用insert标签的子标签selectKey实现；-自学，了解，使用不多" class="headerlink" title="实现一：使用insert标签的子标签selectKey实现；(自学，了解，使用不多)"></a><strong>实现一：使用insert标签的子标签selectKey实现；(自学，了解，使用不多)</strong></h4><table>
<thead>
<tr>
<th>属性</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>keyColumn</td>
<td>主键在表中对应的列名</td>
</tr>
<tr>
<td>keyProperty</td>
<td>主键在实体类中对应的属性名</td>
</tr>
<tr>
<td>resultType</td>
<td>主键的数据类型</td>
</tr>
<tr>
<td>order</td>
<td>BEFORE:会首先选择主键,设置 keyProperty 然后执行插入语句 <br />AFTER: 在添加语句后执行查询主键的语句</td>
</tr>
</tbody></table>
<p>【映射文件】</p>
<p>mysql中的函数：<strong>last_insert_id()</strong> 得到最后添加的主键</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">添加用户</span></span><br><span class="line"><span class="comment">因为增删改没有查询的结果集，所以不用配置resultType</span></span><br><span class="line"><span class="comment">有返回值，返回影响的行数</span></span><br><span class="line"><span class="comment"> --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;saveUser&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;user&quot;</span>&gt;</span></span><br><span class="line">    insert into user values (null,#&#123;username&#125;,#&#123;birthday&#125;,#&#123;sex&#125;,#&#123;address&#125;)</span><br><span class="line">   <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">    keyColumn:主键在表中对应的列名</span></span><br><span class="line"><span class="comment">    keyProperty:主键在实体类中对应的属性名</span></span><br><span class="line"><span class="comment">    resultType:主键的数据类型</span></span><br><span class="line"><span class="comment">    order:</span></span><br><span class="line"><span class="comment">        BEFORE: 在添加语句前执行查询主键的语句</span></span><br><span class="line"><span class="comment">        AFTER: 在添加语句后执行查询主键的语句</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">selectKey</span> <span class="attr">keyColumn</span>=<span class="string">&quot;id&quot;</span> <span class="attr">keyProperty</span>=<span class="string">&quot;id&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;int&quot;</span> <span class="attr">order</span>=<span class="string">&quot;AFTER&quot;</span>&gt;</span></span><br><span class="line">        select last_insert_id()</span><br><span class="line">    <span class="tag">&lt;/<span class="name">selectKey</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>测试代码</p>
<p>通过getId()得到新增的主键值</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> 添加1个用户</span></span><br><span class="line"><span class="comment"> 在mybatis中增删改，默认是手动提交事务</span></span><br><span class="line"><span class="comment"> 1. 设置成自动提交 factory.openSession(true);</span></span><br><span class="line"><span class="comment"> 2. 自己手动提交 session.commit();</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">saveUser</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">        user.setUsername(<span class="string">&quot;蔡徐坤&quot;</span>);</span><br><span class="line">        user.setBirthday(<span class="keyword">new</span> <span class="title class_">Date</span>());</span><br><span class="line">        user.setSex(<span class="string">&quot;男&quot;</span>);</span><br><span class="line">        user.setAddress(<span class="string">&quot;上海&quot;</span>);</span><br><span class="line"></span><br><span class="line">        userMapper.saveUser(user);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//查看新的数据的主键值</span></span><br><span class="line">        System.out.println(user.getId());<span class="comment">//8</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h4 id="实现二：使用insert标签的属性useGeneratedKeys，keyProperty，keyColumn实现；"><a href="#实现二：使用insert标签的属性useGeneratedKeys，keyProperty，keyColumn实现；" class="headerlink" title="实现二：使用insert标签的属性useGeneratedKeys，keyProperty，keyColumn实现；"></a><strong>实现二：使用insert标签的属性useGeneratedKeys，keyProperty，keyColumn实现；</strong></h4><table>
<thead>
<tr>
<th>属性</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>useGeneratedKeys</td>
<td>true 获取自动生成的主键，相当于select last_insert_id()</td>
</tr>
<tr>
<td>keyColumn</td>
<td>表中主键的列名</td>
</tr>
<tr>
<td>keyProperty</td>
<td>实体类中主键的属性名</td>
</tr>
</tbody></table>
<p>映射文件</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;saveUser&quot;</span> <span class="attr">useGeneratedKeys</span>=<span class="string">&quot;true&quot;</span> <span class="attr">keyColumn</span>=<span class="string">&quot;id&quot;</span> <span class="attr">keyProperty</span>=<span class="string">&quot;id&quot;</span>&gt;</span></span><br><span class="line">        insert into user values (null ,#&#123;username&#125;,#&#123;birthday&#125;,#&#123;sex&#125;,#&#123;address&#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>说明：直接在insert标签中增加属性的方式，只适合于支持自动增长主键类型的数据库，比如MySQL或SQL Server。</li>
</ul>
<h4 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h4><ol>
<li><p>添加用户使用哪个标签？</p>
<p>insert</p>
</li>
<li><p>得到主键值有哪两种方式？</p>
<ol>
<li>子标签：selectKey</li>
<li>在insert中添加属性</li>
</ol>
</li>
<li><p>在mysql中得到主键的函数： last_insert_id()</p>
</li>
</ol>
<h3 id="【3】单个参数，多个参数-重点"><a href="#【3】单个参数，多个参数-重点" class="headerlink" title="【3】单个参数，多个参数(重点)"></a>【3】单个参数，多个参数(重点)</h3><p>主要是针对简单类型的数据(int,string,long,Date)等数据进行入参处理。</p>
<h4 id="【单个参数】"><a href="#【单个参数】" class="headerlink" title="【单个参数】"></a>【单个参数】</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">单个参数：接口方法传入一个参数</span><br></pre></td></tr></table></figure>

<h5 id="【接口传参】"><a href="#【接口传参】" class="headerlink" title="【接口传参】"></a>【接口传参】</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">User <span class="title function_">queryById</span><span class="params">(Integer id)</span>;</span><br></pre></td></tr></table></figure>

<h5 id="【接收参数】"><a href="#【接收参数】" class="headerlink" title="【接收参数】"></a>【接收参数】</h5><p><strong>1、通过#{参数名}接收</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--根据id查询--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;queryById&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;User&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span>&gt;</span></span><br><span class="line">    select *,user_name AS  userName from user where id = #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>2、通过#{任意变量名}接收</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--根据id查询--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;queryById&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;User&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span>&gt;</span></span><br><span class="line">    select *,user_name AS  userName from user where id = #&#123;abc&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="【结论】"><a href="#【结论】" class="headerlink" title="【结论】"></a>【结论】</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">当接口方法传入一个参数时，mybatis不做特殊处理，只需要#&#123;任意变量名&#125;都可接收；</span><br></pre></td></tr></table></figure>



<h4 id="【多个参数】"><a href="#【多个参数】" class="headerlink" title="【多个参数】"></a>【多个参数】</h4><p>需求：根据用户名和性别查询用户</p>
<h5 id="【接口传参】-1"><a href="#【接口传参】-1" class="headerlink" title="【接口传参】"></a>【接口传参】</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//根据用户名和性别查询</span></span><br><span class="line">User <span class="title function_">queryByUserNameAndSex</span><span class="params">(String userName, String sex)</span>;</span><br></pre></td></tr></table></figure>

<p>【UserMapper.xml】</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;queryByUserNameAndSex&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">        select * from user where username=#&#123;username&#125; and sex=#&#123;sex&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>【测试类】</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">queryByUserNameAndSex</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userMapper.queryByUserNameAndSex(<span class="string">&quot;孙悟空&quot;</span>, <span class="string">&quot;男&quot;</span>);</span><br><span class="line">    System.out.println(<span class="string">&quot;user = &quot;</span> + user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>【结果】</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://js.hnlyx.top/img/image-20200605223006691-164197976098211.png" alt="image-20200605223006691"></p>
<p>上述报异常了，当传入多个参数时，mybatis底层进行了处理。我们需要按照如下几种方式解决异常：</p>
<h5 id="【接收参数】-1"><a href="#【接收参数】-1" class="headerlink" title="【接收参数】"></a>【接收参数】</h5><p><strong>1、使用参数索引获取：arg0,arg1</strong>(了解)</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--根据用户名和性别查询--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;queryByUserNameAndSex&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">        select * from user where username=#&#123;arg0&#125; and sex=#&#123;arg1&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>说明：</p>
<p>这里的sql语句的参数书写顺序：select * from user where username&#x3D;#{arg0} and sex&#x3D;#{arg1}</p>
<p>和User user &#x3D; userMapper.queryByUserNameAndSex(“孙悟空”, “男”); 传递实参顺序一致。</p>
<p>也就是说：username&#x3D;#{arg0}  —》arg0的值是姓名孙悟空。</p>
<p>sex&#x3D;#{arg1}—》arg1的值是性别男。</p>
<p><strong>2、使用参数位置获取：param1,param2</strong>(了解)</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">&lt;!--根据用户名和性别查询--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;queryByUserNameAndSex&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">     select * from user where username=#&#123;param1&#125; and sex=#&#123;param2&#125;</span><br><span class="line"> <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>3、使用命名参数获取，明确指定传入参数的名称：</strong>(掌握)</p>
<p>  步骤一：在接口中传入参数时通过@Param指定参数名称</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//根据用户名和性别查询</span></span><br><span class="line">User <span class="title function_">queryByUserNameAndSex</span><span class="params">(<span class="meta">@Param(&quot;username&quot;)</span> String userName, <span class="meta">@Param(&quot;sex&quot;)</span> String sex)</span>;</span><br></pre></td></tr></table></figure>

<p>  步骤二：在接收参数时，通过指定的名称获取参数值；</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--根据用户名和性别查询--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;queryByUserNameAndSex&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--#&#123;username&#125;这里的username是@Param(&quot;username&quot;)，也就是说@Param(&quot;标识符&quot;)标识符是什么，这里就写什么--&gt;</span></span><br><span class="line">    select * from user where username=#&#123;username&#125; and sex=#&#123;sex&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h5 id="【小结】"><a href="#【小结】" class="headerlink" title="【小结】"></a>【小结】</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">1、传入多个参数时，mybatis底层处理 ，先放到一个Object数组中，然后放到了Map集合中， Object[] == &gt; Map&lt;Key,Value&gt;  key-param1 key-username</span><br><span class="line">  Key值为：param1,param2......  </span><br><span class="line">  Value值为具体的内容；</span><br><span class="line"></span><br><span class="line">2、多个参数的取值方式：</span><br><span class="line">  	参数索引：#&#123;arg0&#125; #&#123;arg1&#125;</span><br><span class="line">    参数位置：#&#123;param1&#125; #&#123;param2&#125; </span><br><span class="line">    命名参数：#&#123;参数名&#125;  </span><br><span class="line">3、无论使用的是单个参数还是多个参数，建议都使用命名参数进行传值；</span><br></pre></td></tr></table></figure>



<h3 id="【4】pojo参数【重点】"><a href="#【4】pojo参数【重点】" class="headerlink" title="【4】pojo参数【重点】"></a>【4】pojo参数【重点】</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">使用pojo来传递参数</span><br></pre></td></tr></table></figure>

<p><strong>接口添加方法：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//新增</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">saveUser</span><span class="params">(User user)</span>;</span><br></pre></td></tr></table></figure>

<p><strong>映射文件：</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--新增--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;saveUser&quot;</span>&gt;</span></span><br><span class="line">    insert into user values (null ,#&#123;username&#125;,#&#123;birthday&#125;,#&#123;sex&#125;,#&#123;address&#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>说明：接口方法传入pojo类型的数据时，mybatis底层直接使用pojo封装数据。  sql语句中  #{username}取值&#x3D;&#x3D;》到pojo中调用 getUsername(){}</p>
<p><strong>测试:</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">saveUser</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">    user.setUsername(<span class="string">&quot;蔡徐坤&quot;</span>);</span><br><span class="line">    user.setBirthday(<span class="keyword">new</span> <span class="title class_">Date</span>());</span><br><span class="line">    user.setSex(<span class="string">&quot;男&quot;</span>);</span><br><span class="line">    user.setAddress(<span class="string">&quot;上海&quot;</span>);</span><br><span class="line">    userMapper.saveUser(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="【5】HashMap参数"><a href="#【5】HashMap参数" class="headerlink" title="【5】HashMap参数"></a>【5】HashMap参数</h3><p>需求：模拟用户登录，登录方法参数是Map集合，泛型都是String类型分别表示用户名和性别。</p>
<p>在UserMapper接口中添加以下方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 用户登陆，参数为map</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">User <span class="title function_">login</span><span class="params">(Map&lt;String,String&gt; map)</span>;</span><br></pre></td></tr></table></figure>



<p><strong>UserMapper配置文件：</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">   将map的key作为参数名称来传递参数</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;login&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">     select * from user where username=#&#123;username&#125; and sex=#&#123;sex&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p><strong>测试用例：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">login</span><span class="params">()</span>&#123;</span><br><span class="line">    Map&lt;String, String&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    map.put(<span class="string">&quot;username&quot;</span>,<span class="string">&quot;孙悟空&quot;</span>);</span><br><span class="line">    map.put(<span class="string">&quot;sex&quot;</span>,<span class="string">&quot;男&quot;</span>);</span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userMapper.login(map);</span><br><span class="line">    System.out.println(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>注意事项：</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">参数map中的key值是与SQL语句中 #&#123;&#125; 的取值名称一致。</span><br></pre></td></tr></table></figure>

<h3 id="【6】入参小结：接口方法传入的参数"><a href="#【6】入参小结：接口方法传入的参数" class="headerlink" title="【6】入参小结：接口方法传入的参数"></a>【6】入参小结：接口方法传入的参数</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">mybatis中能够接收<span class="number">2</span>种类型的参数传入：</span><br><span class="line"></span><br><span class="line">【<span class="number">1</span>】基本类型数据：</span><br><span class="line">	 单个数据： queryById(Integer id);</span><br><span class="line">		 mybatis底层不做处理，使用任意变量都可接收   #&#123;abc&#125;</span><br><span class="line">	 多个数据： queryByUsernameAndSex(<span class="meta">@Param(&quot;username&quot;)</span>String username,<span class="meta">@Param(&quot;sex&quot;)</span>String sex);</span><br><span class="line">		mybatis底层：</span><br><span class="line">			第一步：把多个参数存储进数组最后放到集合map中，Map&#123;arg0,arg1&#125;    #&#123;arg0&#125; #&#123;arg1&#125;</span><br><span class="line">			第二步：把数组中的数据转入Map中：</span><br><span class="line">					username参数： param1-白骨精   username-白骨精</span><br><span class="line">		     多个参数sql取值： #&#123;param1&#125;  #&#123;param2&#125;</span><br><span class="line">							#&#123;username&#125;</span><br><span class="line">    最佳实践： 使用命名参数取值   queryByUsernameAndSex(<span class="meta">@Param(&quot;username&quot;)</span>String username);</span><br><span class="line">			 sql取值：  #&#123;username&#125; ****</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">【<span class="number">2</span>】复杂数据类型：</span><br><span class="line">	<span class="number">1.</span>pojo类型数据：mybatis底层直接使用pojo封装数据</span><br><span class="line">			sql取值：  #&#123;pojo的属性名&#125;****   #&#123;username&#125;==&gt;调用pojo的 getUsername()&#123;&#125; </span><br><span class="line">		</span><br><span class="line"></span><br><span class="line">	<span class="number">2.</span>map集合数据：mybatis底层直接使用map封装参数</span><br><span class="line">			Map&lt;String,String&gt;  <span class="title function_">put</span><span class="params">(<span class="string">&quot;username&quot;</span>,<span class="string">&quot;白骨精&quot;</span>)</span></span><br><span class="line">              #&#123;username&#125;****</span><br></pre></td></tr></table></figure>



<h2 id="2、参数值的获取"><a href="#2、参数值的获取" class="headerlink" title="2、参数值的获取"></a>2、参数值的获取</h2><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://js.hnlyx.top/img/image-20200606075427516-164197976098212.png" alt="image-20200606075427516"></p>
<p>说明：我们上述一直在讲解接口中的方法传入的参数，那么接下来我们要讲解如何在sql语句中获取传入的数据，其实我们之前也在一直使用一种方式就是**#{}**的方式。	</p>
<p>参数值的获取指的是，statement获取接口方法中传入的参数。获取参数，有两种方式：**#{}<strong>和</strong>${}**；</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:/Users/Administrator/Desktop/Hexo/gift95.github.io/source/_posts/img/1573118237093-164197976098215.png" alt="1573118237093"> </p>
<h3 id="【1】-和-取值"><a href="#【1】-和-取值" class="headerlink" title="【1】#{}和${}取值"></a>【1】#{}和${}取值</h3><p><strong><code>#&#123;&#125;</code> 取值：</strong></p>
<p> <img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:/Users/Administrator/Desktop/Hexo/gift95.github.io/source/_posts/img/1573118237093-164197976098215.png" alt="1573118237093"></p>
<p>mybatis后台处理：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:/Users/Administrator/Desktop/Hexo/gift95.github.io/source/_posts/img/1573118291670-164197976098213.png" alt="1573118291670"> </p>
<p><strong><code>$&#123;&#125;</code> 取值：</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:/Users/Administrator/Desktop/Hexo/gift95.github.io/source/_posts/img/1573118342607-164197976098214.png" alt="1573118342607"> </p>
<p>mybatis后台处理：</p>
<p>【接口方法】</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//根据id查询</span></span><br><span class="line">User <span class="title function_">queryById</span><span class="params">(<span class="meta">@Param(&quot;id&quot;)</span> Integer id)</span>;</span><br></pre></td></tr></table></figure>

<p>【测试类】</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">queryById</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    <span class="comment">//获取mapper接口的动态代理实现</span></span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userMapper.queryById(<span class="number">1</span>);</span><br><span class="line">    System.out.println(<span class="string">&quot;user = &quot;</span> + user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:/Users/Administrator/Desktop/Hexo/gift95.github.io/source/_posts/img/1573118364849-164197976098217.png" alt="1573118364849"> </p>
<p>【注意】${id} 获取id值时，必须使用命名参数取值：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:/Users/Administrator/Desktop/Hexo/gift95.github.io/source/_posts/img/1573118417029-164197976098216.png" alt="1573118417029"> </p>
<p>如果不使用命名参数取值，即不在接口中加入@Param(“id”)，就会报异常：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:/Users/Administrator/Desktop/Hexo/gift95.github.io/source/_posts/img/image-20200606085015291-164197976098218.png" alt="image-20200606085015291"></p>
<p><strong>【小结】</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">1、SQL语句中获取参数的方式：</span><br><span class="line">	#&#123;xxx&#125;  sql:select * from user where id = ?</span><br><span class="line">	$&#123;xxx&#125; sql:select * from user where id = 1</span><br><span class="line">2、取值的相同点：</span><br><span class="line">	都能够获取接口方法传入的参数值</span><br><span class="line">3、取值的不同点：</span><br><span class="line">	#&#123;&#125;取值：是以预编译的形式将参数设置到SQL语句中。PreparedStatement 防止SQL注入；</span><br><span class="line">	$&#123;&#125;取值：直接把获取到的参数值，拼接到sql语句中，会有安全问题；不能防止SQL注入；</span><br><span class="line">4、小结：</span><br><span class="line">	SQL传入参数的获取使用#&#123;&#125;；</span><br><span class="line">	拼接参数使用$&#123;&#125;；</span><br></pre></td></tr></table></figure>



<h3 id="【2】-取值的应用场景"><a href="#【2】-取值的应用场景" class="headerlink" title="【2】${}取值的应用场景"></a>【2】${}取值的应用场景</h3><pre><code>在一些特殊的应用场景中，需要对SQL语句部分（不是参数）进行拼接，这个时候就必须使用$&#123;&#125;来进行拼接，不能使用#&#123;&#125;.例如：
</code></pre>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">	1、企业开发中随着数据量的增大，往往会将数据表按照年份进行分表，如：2017_user，2018_user....，对这些表进行查询就需要动态把年份传入进来，而年份是表名的一部分，并不是参数，JDBC无法对其预编译，所以只能使用$&#123;&#125;进行拼接：  </span><br><span class="line">	SELECT * FROM $&#123;year&#125;_user；</span><br><span class="line">	</span><br><span class="line">	2、根据表名查询数据总记录数：</span><br><span class="line">		SELECT COUNT(*) FROM user</span><br><span class="line">		SELECT COUNT(*) FROM order</span><br><span class="line">		SELECT COUNT(*) FROM  $&#123;tableName&#125;</span><br><span class="line">简言之：如果需要设置到SQL中的不是查询的条件，只能使用$&#123;&#125;拼接；</span><br></pre></td></tr></table></figure>

<p><strong>示例：</strong></p>
<p>需求：查询user表中的总记录数。</p>
<p>【映射文件】：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectCountByTableName&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;int&quot;</span>&gt;</span></span><br><span class="line">     select count(*) from $&#123;tableName&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>【接口】：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//需求：查询user表中的总记录数。</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">selectCountByTableName</span><span class="params">(<span class="meta">@Param(&quot;tableName&quot;)</span> String table)</span>;</span><br></pre></td></tr></table></figure>

<p>【测试类】</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">selectCountByTableName</span><span class="params">()</span>&#123;</span><br><span class="line">     <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> userMapper.selectCountByTableName(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">     System.out.println(<span class="string">&quot;count = &quot;</span> + count);</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<p><strong>小结：</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SQL中非参数部分的拼接使用$&#123;&#125;</span><br><span class="line">举例：</span><br><span class="line">	select * from user where username=#&#123;username&#125; and sex=#&#123;sex&#125; 这里 #&#123;username&#125; #&#123;sex&#125; 都属于参数部分，所以是#&#123;&#125;</span><br><span class="line">	 select count(*) from $&#123;tableName&#125; 这里$&#123;tableName&#125; 属于表名，不是参数部分，所以使用$&#123;&#125;</span><br></pre></td></tr></table></figure>

<h3 id="【3】-取值注意事项"><a href="#【3】-取值注意事项" class="headerlink" title="【3】${}取值注意事项"></a>【3】${}取值注意事项</h3><p><strong>【 ${}获取单个值】</strong>了解</p>
<pre><code>`$&#123;&#125;` 获取单个值时，最好是通过命名参数的形式获取。如果不指定参数的，也可以使用$&#123;value&#125;来获取传入的单个值；
</code></pre>
<p>传入参数：没有指定参数名称</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:/Users/Administrator/Desktop/Hexo/gift95.github.io/source/_posts/img/1565610853419-164197976098219.png" alt="1565610853419"> </p>
<p>获取参数：通过${value获取}</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:/Users/Administrator/Desktop/Hexo/gift95.github.io/source/_posts/img/1565610902438-164197976098220.png" alt="1565610902438"> </p>
<p><strong>【${}获取配置文件中的值】</strong></p>
<p>有时候，我们如果非要使用$来接收参数，将login修改如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--根据用户名和性别查询--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;queryByUserNameAndSex&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">    SELECT  * FROM  user WHERE  user_name = &#x27;$&#123;username&#125;&#x27; AND  sex = #&#123;sex&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>说明：上述sql语句中：SELECT  * FROM  user WHERE  user_name &#x3D; <strong>‘${username}’</strong> AND  sex &#x3D; #{sex}</p>
<p>对于 ‘${username}’ 加单引号是因为${}获取数据的方式直接将获取的数据拼接到字符串上，并不会加引号，如果获取的值是数值型，没有问题，但是如果是字符类型就会有问题，所以需要加上引号进行拼接。</p>
<p>假设${username}获取的值是锁哥，那么不加单引号效果是：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span>  <span class="operator">*</span> <span class="keyword">FROM</span>  <span class="keyword">user</span> <span class="keyword">WHERE</span>  user_name <span class="operator">=</span> 锁哥 <span class="keyword">AND</span>  sex <span class="operator">=</span> #&#123;sex&#125; </span><br><span class="line">显然是不可以的，而加上单引号效果就是：</span><br><span class="line"><span class="keyword">SELECT</span>  <span class="operator">*</span> <span class="keyword">FROM</span>  <span class="keyword">user</span> <span class="keyword">WHERE</span>  user_name <span class="operator">=</span> <span class="string">&#x27;锁哥&#x27;</span> <span class="keyword">AND</span>  sex <span class="operator">=</span> #&#123;sex&#125; </span><br></pre></td></tr></table></figure>



<p><strong>测试方法：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">queryByUserNameAndPassword</span><span class="params">( )</span>&#123;</span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userMapper.queryByUserNameAndSex(<span class="string">&quot;孙悟空&quot;</span>, <span class="string">&quot;男&quot;</span>);</span><br><span class="line">    System.out.println(<span class="string">&quot;user = &quot;</span> + user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>执行测试：</strong>发现测试方法中传递的参数明明是孙悟空，却获取到了jdbc.properties资源文件中的root.</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:/Users/Administrator/Desktop/Hexo/gift95.github.io/source/_posts/img/1573118680129-164197976098221.png" alt="1573118680129">                             </p>
<p><strong>原因：</strong><code>$</code>可以获取资源文件中的数据，比如mybatis-config.xml中使用<code>$</code>获取连接信息就是。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;property name=&quot;driver&quot; value=&quot;$&#123;driver&#125;&quot;/&gt;</span><br></pre></td></tr></table></figure>

<p>由于映射文件中使用的${username}的参数名称正好和资源文件jdbc.properties中的key相同，因此获取到了资源文件中的数据。</p>
<pre><code>这种错误发生的根本原因是因为资源文件中的key和参数名称重名了，为了解决这个文件，我们只需要将资源文件中的key设置成唯一的不会被重复的key即可。
</code></pre>
<p>解决方案：在资源文件中的key中添加前缀</p>
<p><strong>修改资源文件：</strong></p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">jdbc.driverClass</span>=<span class="string">com.mysql.jdbc.Driver</span></span><br><span class="line"><span class="attr">jdbc.url</span>=<span class="string">jdbc:mysql://localhost:3306/heima37</span></span><br><span class="line"><span class="attr">jdbc.username</span>=<span class="string">root</span></span><br><span class="line"><span class="attr">jdbc.password</span>=<span class="string">root</span></span><br></pre></td></tr></table></figure>

<p><strong>修改mybatis-config.xml：</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">&quot;POOLED&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 配置连接信息 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driver&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.driverClass&#125;&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.url&#125;&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.username&#125;&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.password&#125;&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="【小结】-1"><a href="#【小结】-1" class="headerlink" title="【小结】"></a>【小结】</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">1、#&#123;&#125;和$&#123;&#125;取值的相同点：</span><br><span class="line">	  都能够获取传入的命名参数</span><br><span class="line"></span><br><span class="line">2、#&#123;&#125;和$&#123;&#125;取值的不同点：</span><br><span class="line">	#&#123;&#125;: 以预编译的方式将参数设置到sql语句中  防止SQL注入 。可以自动加单引号</span><br><span class="line">	$&#123;&#125;: 把参数直接拼接到sql语句中  不能够防止sql注入。不能自动加单引号。</span><br><span class="line">3、具体应用：</span><br><span class="line">	#&#123;&#125;获取sql语句中的条件参数</span><br><span class="line">	$&#123;&#125;应用于sql语句拼接和读取配置文件</span><br><span class="line">	</span><br></pre></td></tr></table></figure>



<h3 id="扩展-mysql自带函数concat拼接使用"><a href="#扩展-mysql自带函数concat拼接使用" class="headerlink" title="扩展 mysql自带函数concat拼接使用"></a>扩展 mysql自带函数concat拼接使用</h3><p>UserMapper接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserMapper</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">        需求：模糊查询地址中含有 海 的用户</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    List&lt;User&gt; <span class="title function_">queryUsersByAddressLike</span><span class="params">(<span class="meta">@Param(&quot;address&quot;)</span>String address)</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>UserMapper.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">       需求：模糊查询地址中含有 海 的用户</span></span><br><span class="line"><span class="comment">       List&lt;User&gt; queryUsersByAddressLike(@Param(&quot;address&quot;)String address);</span></span><br><span class="line"><span class="comment">       注意：</span></span><br><span class="line"><span class="comment">           1. select * from user where address like &#x27;%#&#123;address&#125;%&#x27; 这里是拼接，不能使用#&#123;&#125;,必须使用$&#123;&#125;</span></span><br><span class="line"><span class="comment">               使用$&#123;&#125;拼接sql语句： select * from user where address like &#x27;%$&#123;address&#125;%&#x27;===select * from user where address like &#x27;%海%&#x27;</span></span><br><span class="line"><span class="comment">               但是我们发现具有sql注入问题</span></span><br><span class="line"><span class="comment">           2.我们实际开发中必须考虑sql注入问题，那么还必须是实现拼接，使用mysql自带拼接函数：concat(数值1,数值2,数值3,....);</span></span><br><span class="line"><span class="comment">                select * from user where address like concat(&#x27;%&#x27;,?,&#x27;%&#x27;)</span></span><br><span class="line"><span class="comment">   --&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- &lt;select id=&quot;queryUsersByAddressLike&quot; resultType=&quot;User&quot;&gt;</span></span><br><span class="line"><span class="comment">       select * from user where address like &#x27;%$&#123;address&#125;%&#x27;</span></span><br><span class="line"><span class="comment">   &lt;/select&gt;--&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;queryUsersByAddressLike&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">       select * from user where address like concat(&#x27;%&#x27;,#&#123;address&#125;,&#x27;%&#x27;)</span><br><span class="line">   <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>测试类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">        需求：模糊查询地址中含有 海 的用户</span></span><br><span class="line"><span class="comment">        List&lt;User&gt; queryUsersByAddressLike(@Param(&quot;address&quot;)String address);</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">queryUsersByAddressLike</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">SqlSession</span> <span class="variable">sqlSession</span> <span class="operator">=</span> SqlSessionUtil.getSqlSession();</span><br><span class="line">        <span class="comment">//4.获取接口代理对象</span></span><br><span class="line">        <span class="type">UserMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> sqlSession.getMapper(UserMapper.class);</span><br><span class="line"></span><br><span class="line">        List&lt;User&gt; list = mapper.queryUsersByAddressLike(<span class="string">&quot;海&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;list = &quot;</span> + list);</span><br><span class="line"></span><br><span class="line">        sqlSession.close();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>



<h3 id="入参总结："><a href="#入参总结：" class="headerlink" title="入参总结："></a>入参总结：</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">mybatis中能够接收<span class="number">2</span>种类型的参数传入：</span><br><span class="line"></span><br><span class="line">【<span class="number">1</span>】基本类型数据：</span><br><span class="line">	 单个数据： queryById(Integer id);</span><br><span class="line">		 mybatis底层不做处理，使用任意变量都可接收   #&#123;abc&#125;</span><br><span class="line">	 多个数据： queryByUsernameAndSex(<span class="meta">@Param(&quot;username&quot;)</span>String username,<span class="meta">@Param(&quot;sex&quot;)</span>String sex);</span><br><span class="line">		mybatis底层：</span><br><span class="line">			第一步：把多个参数存储进数组最后放到集合map中，Map&#123;arg0,arg1&#125;    #&#123;arg0&#125; #&#123;arg1&#125;</span><br><span class="line">			第二步：把数组中的数据转入Map中：</span><br><span class="line">					username参数： param1-白骨精   username-白骨精</span><br><span class="line">		     多个参数sql取值： #&#123;param1&#125;  #&#123;param2&#125;</span><br><span class="line">							#&#123;username&#125;</span><br><span class="line">    最佳实践： 使用命名参数取值   queryByUsernameAndSex(<span class="meta">@Param(&quot;username&quot;)</span>String username);</span><br><span class="line">			 sql取值：  #&#123;username&#125; ****</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">【<span class="number">2</span>】复杂数据类型：</span><br><span class="line">	<span class="number">1.</span>pojo类型数据：mybatis底层直接使用pojo封装数据</span><br><span class="line">			sql取值：  #&#123;pojo的属性名&#125;****   #&#123;username&#125;==&gt;调用pojo的 getUsername()&#123;&#125; </span><br><span class="line">		</span><br><span class="line"></span><br><span class="line">	<span class="number">2.</span>map集合数据：mybatis底层直接使用map封装参数</span><br><span class="line">			Map&lt;String,String&gt;  <span class="title function_">put</span><span class="params">(<span class="string">&quot;username&quot;</span>,<span class="string">&quot;白骨精&quot;</span>)</span></span><br><span class="line">              #&#123;username&#125;****</span><br><span class="line"> 【<span class="number">3</span>】#&#123;&#125;和$&#123;&#125;取值的相同点：</span><br><span class="line">	  都能够获取传入的命名参数</span><br><span class="line"></span><br><span class="line">  【<span class="number">4</span>】#&#123;&#125;和$&#123;&#125;取值的不同点：</span><br><span class="line">	#&#123;&#125;: 以预编译的方式将参数设置到sql语句中  防止SQL注入 。可以自动加单引号</span><br><span class="line">	$&#123;&#125;: 把参数直接拼接到sql语句中  不能够防止sql注入。不能自动加单引号。</span><br><span class="line"> 【<span class="number">5</span>】具体应用：</span><br><span class="line">	#&#123;&#125;获取sql语句中的条件参数</span><br><span class="line">	$&#123;&#125;应用于sql语句拼接和读取配置文件</span><br><span class="line">  【<span class="number">6</span>】如果避免sql注入，并且还是sql的拼接，解决方案：</span><br><span class="line">        	此时可以使用mysql自带函数，拼接函数：concat(数值<span class="number">1</span>,数值<span class="number">2</span>,数值<span class="number">3</span>,....) 可以将concat函数中的数据拼接为一个值</span><br><span class="line">                  举例：concat(<span class="string">&#x27;%&#x27;</span>,<span class="string">&#x27;锁哥&#x27;</span>,<span class="string">&#x27;%&#x27;</span>)===》结果是<span class="string">&#x27;%锁哥%&#x27;</span></span><br><span class="line">                        concat(<span class="string">&#x27;%&#x27;</span>,#&#123;userName&#125;,<span class="string">&#x27;%&#x27;</span>) ===&gt;假设#&#123;userName&#125;获取的值是 喆===》<span class="string">&#x27;%喆%&#x27;</span></span><br><span class="line">        </span><br><span class="line">        select * from user where user_name like <span class="title function_">concat</span><span class="params">(<span class="string">&#x27;%&#x27;</span>,#&#123;userName&#125;,<span class="string">&#x27;%&#x27;</span>)</span></span><br><span class="line">        </span><br></pre></td></tr></table></figure>





<h2 id="3、结果映射"><a href="#3、结果映射" class="headerlink" title="3、结果映射"></a>3、结果映射</h2><p>我们已经学习了入参和获取参数的方式，接下来学习最后的返回值。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://js.hnlyx.top/img/image-20200606093702073-164197976098222.png" alt="image-20200606093702073"></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">在使用原生的JDBC操作时，对于结果集ResultSet，需要手动处理。mybatis框架提供了resultType和resultMap来对结果集进行封装。</span><br></pre></td></tr></table></figure>

<p><strong>注意：只要一个方法有返回值需要处理，那么 resultType和resultMap必须有一个</strong></p>
<h3 id="【1】resultType"><a href="#【1】resultType" class="headerlink" title="【1】resultType"></a>【1】resultType</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">从sql语句中返回的期望类型的类的完全限定名或别名。 注意如果返回的是集合，那应该设置为集合包含的类型，而不是集合本身。可以使用 resultType 或 resultMap，但不能同时使用。</span><br></pre></td></tr></table></figure>

<h4 id="1-1返回值是简单类型"><a href="#1-1返回值是简单类型" class="headerlink" title="1.1返回值是简单类型"></a>1.1返回值是简单类型</h4><p>例如 int ,string &#x3D;&#x3D;&#x3D;&gt;resultType&#x3D;”书写对应的基本类型别名或者全名即可”</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:/Users/Administrator/Desktop/Hexo/gift95.github.io/source/_posts/img/image-20200606103412396-164197976099323.png" alt="image-20200606103412396"></p>
<h4 id="1-2返回值为一个pojo-User-对象时"><a href="#1-2返回值为一个pojo-User-对象时" class="headerlink" title="1.2返回值为一个pojo(User)对象时"></a>1.2返回值为一个pojo(User)对象时</h4><p>【定义resultType为User】</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:/Users/Administrator/Desktop/Hexo/gift95.github.io/source/_posts/img/1564483479082-164197976099324.png" alt="1564483479082"> </p>
<p> 【使用User来接收返回值】</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:/Users/Administrator/Desktop/Hexo/gift95.github.io/source/_posts/img/1564538720710-164197976099325.png" alt="1564538720710"></p>
<h4 id="1-3返回值为一个List时"><a href="#1-3返回值为一个List时" class="headerlink" title="1.3返回值为一个List时"></a>1.3返回值为一个List<User>时</h4><pre><code>当返回值为List集合时，resultType需要设置成集合中存储的具体的pojo数据类型：
</code></pre>
<p>【映射文件】</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:/Users/Administrator/Desktop/Hexo/gift95.github.io/source/_posts/img/image-20200606103712740-164197976099327.png" alt="image-20200606103712740"></p>
<p>【接口】</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:/Users/Administrator/Desktop/Hexo/gift95.github.io/source/_posts/img/image-20200606103756850-164197976099326.png" alt="image-20200606103756850"></p>
<p>【测试类】</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.使用接口对象调用接口中的方法</span></span><br><span class="line">List&lt;User&gt; userList = mapper.findAllUsers();</span><br><span class="line"><span class="comment">//2.遍历集合</span></span><br><span class="line"><span class="keyword">for</span> (User user : userList) &#123;</span><br><span class="line">    System.out.println(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="1-4返回值为map"><a href="#1-4返回值为map" class="headerlink" title="1.4返回值为map"></a>1.4返回值为map</h4><h5 id="【1】返回一条数据，封装到map中"><a href="#【1】返回一条数据，封装到map中" class="headerlink" title="【1】返回一条数据，封装到map中"></a>【1】返回一条数据，封装到map中</h5><p>需求：查询id是1的数据，将查询的结果封装到Map&lt;String,Object&gt;中</p>
<p>接口方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//需求：查询id是1的数据，将查询的结果封装到Map&lt;String,Object&gt;中</span></span><br><span class="line">Map&lt;String,Object&gt; <span class="title function_">selectByIdReturnMap</span><span class="params">(Integer id)</span>;</span><br></pre></td></tr></table></figure>

<p>SQL语句：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectByIdReturnMap&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;map&quot;</span>&gt;</span></span><br><span class="line">        select * from user where id=#&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span> </span><br></pre></td></tr></table></figure>

<p>测试：原来封装到对象中的数据也能够封装到map中</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">selectByIdReturnMap</span><span class="params">()</span>&#123;</span><br><span class="line">    Map&lt;String, Object&gt; map = userMapper.selectByIdReturnMap(<span class="number">1</span>);</span><br><span class="line">    System.out.println(<span class="string">&quot;map = &quot;</span> + map);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">map = &#123;birthday=<span class="number">1980</span>-<span class="number">10</span>-<span class="number">24</span>, address=花果山水帘洞, sex=男, id=<span class="number">1</span>, username=孙悟空&#125;</span><br></pre></td></tr></table></figure>

<p>通过上述结果我们发现如果返回一条数据放到Map中，那么列名会作为Map集合的key,结果作为Map集合的value:</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://js.hnlyx.top/img/image-20200606094904280-164197976099329.png" alt="image-20200606094904280"></p>
<h5 id="【2】返回多条数据，封装到map中"><a href="#【2】返回多条数据，封装到map中" class="headerlink" title="【2】返回多条数据，封装到map中"></a>【2】返回多条数据，封装到map中</h5><pre><code>需求：查询数据表所有的数据封装到Map&lt;String,User&gt;集合中

要求： Key值为一条记录的主键，Value值为pojo的对象.
</code></pre>
<p>​	</p>
<pre><code>如下所示：
</code></pre>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://js.hnlyx.top/img/1565524547986-164197976099328.png" alt="1565524547986"> </p>
<p>接口方法：接口方法上面通过注解 @MapKey指定key值封装的列数据</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//需求：查询数据表所有的数据封装到Map&lt;String,User&gt;集合中</span></span><br><span class="line"> <span class="meta">@MapKey(&quot;id&quot;)</span></span><br><span class="line"> Map&lt;String, User&gt; <span class="title function_">selectReturnMap</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure>

<p>说明：需要在接口的方法上使用注解@MapKey指定数据表中哪一列作为Map集合的key，否则mybatis不知道具体哪个列作为Map集合的key.</p>
<p>SQL语句：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectReturnMap&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;map&quot;</span>&gt;</span></span><br><span class="line">        select * from user</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>测试代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">selectReturnMap</span><span class="params">()</span>&#123;</span><br><span class="line">    Map&lt;String, User&gt; map = userMapper.selectReturnMap();</span><br><span class="line">    System.out.println(<span class="string">&quot;map = &quot;</span> + map);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">map = &#123;<span class="number">1</span>=&#123;birthday=<span class="number">1980</span>-<span class="number">10</span>-<span class="number">24</span>, address=花果山水帘洞, sex=男, id=<span class="number">1</span>, username=孙悟空&#125;, <span class="number">2</span>=&#123;birthday=<span class="number">1992</span>-<span class="number">11</span>-<span class="number">12</span>, address=白虎岭白骨洞, sex=女, id=<span class="number">2</span>, username=白骨精&#125;, <span class="number">3</span>=&#123;birthday=<span class="number">1983</span>-<span class="number">05</span>-<span class="number">20</span>, address=福临山云栈洞, sex=男, id=<span class="number">3</span>, username=猪八戒&#125;, <span class="number">4</span>=&#123;birthday=<span class="number">1995</span>-<span class="number">03</span>-<span class="number">22</span>, address=盤丝洞, sex=女, id=<span class="number">4</span>, username=蜘蛛精&#125;, <span class="number">7</span>=&#123;birthday=<span class="number">2020</span>-<span class="number">06</span>-<span class="number">05</span>, address=上海, sex=男, id=<span class="number">7</span>, username=蔡徐坤&#125;, <span class="number">8</span>=&#123;birthday=<span class="number">2020</span>-<span class="number">06</span>-<span class="number">05</span>, address=上海, sex=男, id=<span class="number">8</span>, username=蔡徐坤&#125;, <span class="number">9</span>=&#123;birthday=<span class="number">2020</span>-<span class="number">06</span>-<span class="number">05</span>, address=上海, sex=男, id=<span class="number">9</span>, username=蔡徐坤&#125;, <span class="number">10</span>=&#123;birthday=<span class="number">2020</span>-<span class="number">06</span>-<span class="number">05</span>, address=上海, sex=男, id=<span class="number">10</span>, username=蔡徐坤&#125;, <span class="number">11</span>=&#123;birthday=<span class="number">2020</span>-<span class="number">06</span>-<span class="number">06</span>, address=上海, sex=男, id=<span class="number">11</span>, username=蔡徐坤&#125;&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h4 id="小结-1"><a href="#小结-1" class="headerlink" title="小结"></a>小结</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>接口方法返回类型是简单类型(除了单列集合)，那么在标签的resultType属性值中书写返回简单类型的类名或者别名</span><br><span class="line">    举例：</span><br><span class="line">    Integer <span class="title function_">show</span><span class="params">()</span>;====&gt; resultType=<span class="string">&quot;int&quot;</span></span><br><span class="line">    String <span class="title function_">show</span><span class="params">()</span>;====&gt; resultType=<span class="string">&quot;string&quot;</span></span><br><span class="line"><span class="number">2.</span>如果接口方法返回类型是简单类型的单列集合，那么在标签的resultType属性值中书写集合的泛型类型</span><br><span class="line">    举例：</span><br><span class="line">    List&lt;User&gt; <span class="title function_">show</span><span class="params">()</span>;====&gt; resultType=<span class="string">&quot;User&quot;</span></span><br><span class="line"><span class="number">3.</span>如果接口方法返回类型是复杂类型的pojo,那么在标签的resultType属性值中书写pojo类型</span><br><span class="line">     举例：</span><br><span class="line">    User <span class="title function_">show</span><span class="params">()</span>;====&gt; resultType=<span class="string">&quot;User&quot;</span></span><br><span class="line"><span class="number">4.</span>如果接口方法返回类型是复杂类型的Map,那么在标签的resultType属性值中书写map类型,但是分为返回的是单行数据还是多行数据：</span><br><span class="line">    	如果是单行数据，不用做处理</span><br><span class="line">    	如果是多行数据，在方法上使用注解<span class="meta">@MapKey(&quot;数据表字段名&quot;)</span>告知mybatis，哪个字段名的值作为map集合的key</span><br><span class="line">    举例： 如果是多行数据</span><br><span class="line">    <span class="meta">@MapKey(&quot;id&quot;)</span></span><br><span class="line">    Map&lt;Integer,Object&gt; <span class="title function_">show</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure>



<h3 id="【2】resultMap-掌握"><a href="#【2】resultMap-掌握" class="headerlink" title="【2】resultMap(掌握)"></a>【2】resultMap(掌握)</h3><p>ResultMap是mybatis中最重要最强大的元素，使用ResultMap可以解决两大问题：</p>
<ol>
<li>POJO属性名和表结构字段名不一致的问题（有些情况下也不是标准的驼峰格式，比如id和userId）</li>
<li>完成高级查询，比如说，一对一、一对多、多对多。(后面多表中会涉及到)</li>
</ol>
<p> 查询数据的时候，查不到userName的信息，原因：数据库的字段名是user_name，而POJO中的属性名字是userName<br>两端不一致，造成mybatis无法填充对应的字段信息。修改方法：在sql语句中使用别名<br><strong>解决方案1</strong>：在sql语句中使用别名</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;queryById&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;user&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span>&gt;</span></span><br><span class="line">   select *,name as username from user where id = #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>解决方案2</strong>：参考驼峰匹配 — mybatis-config.xml 的时候</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;mapUnderscoreToCamelCase&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>注意：这种解决方案只能解决列名是下划线命名.</p>
<p><strong>解决方案3</strong>：resultMap自定义映射</p>
<p>通过案例掌握resultMap的使用方式之一，手动配置实体类中属性和表中字段的映射关系</p>
<h4 id="【需求】"><a href="#【需求】" class="headerlink" title="【需求】"></a>【需求】</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">使用resultMap完成结果集的封装（resultSet===》JavaBean）</span><br></pre></td></tr></table></figure>

<h4 id="【实现步骤】"><a href="#【实现步骤】" class="headerlink" title="【实现步骤】"></a>【实现步骤】</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">手动配置实体类属性和表字段映射关系的步骤如下：</span><br><span class="line">1、	配置自定义结果集<span class="tag">&lt;<span class="name">resultMap</span>&gt;</span></span><br><span class="line">2、	配置id映射</span><br><span class="line">3、	配置其他普通属性的映射</span><br></pre></td></tr></table></figure>

<p><strong>步骤一：</strong>将驼峰匹配注释掉<br>    一旦注释掉驼峰匹配，那么再通过queryUserById查询的结果中，用户名就无法封装了，此时我们可以尝试使用ResultMap来解决这个问题。</p>
<p><strong>步骤二：</strong>配置resultMap</p>
<p>resultMap标签的作用:自定义结果集，自行设置结果集的封装方式</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">id属性：resultMap标签的唯一标识，不能重复，一般是用来被引用的</span><br><span class="line">type属性：结果集的封装类型</span><br><span class="line">autoMapping属性：操作单表时，不配置默认为true,如果pojo对象中的属性名称和表中字段名称相同，则自动映射。</span><br></pre></td></tr></table></figure>

<p>在映射文件中自定义结果集类型：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">            type=&quot;user&quot; 表示结果集的封装类型是user</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;userResultMap&quot;</span> <span class="attr">type</span>=<span class="string">&quot;User&quot;</span> <span class="attr">autoMapping</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!--配置主键映射关系--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!--配置用户名的映射关系  column 表示数据表列  property表示pojo的属性--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;name&quot;</span> <span class="attr">property</span>=<span class="string">&quot;username&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>步骤三</strong>：修改查询语句的statement<br>在查询语句的select标签中通过resultMap属性可以引用自定义结果集作为数据的封装方式。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">     resultMap属性：引用自定义结果集作为数据的封装方式.属性值是自定义resultMap标签的id属性值，这里表示通过id引入自定义的resultMap标签</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;queryById&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;userResultMap&quot;</span>&gt;</span></span><br><span class="line">    select * from user where id = #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>测试代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">queryById</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    <span class="comment">//获取mapper接口的动态代理实现</span></span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userMapper.queryById(<span class="number">1</span>);</span><br><span class="line">    System.out.println(<span class="string">&quot;user = &quot;</span> + user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>注意：</strong>测试完记得将驼峰命名的配置重新开启，因为其他的测试方法还要用。</p>
<h4 id="【小结】-2"><a href="#【小结】-2" class="headerlink" title="【小结】"></a>【小结】</h4><p>resultMap可以用来手动配置属性和字段的映射关系：</p>
<p><strong>属性：</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">1、id属性</span><br><span class="line">定义唯一标识，用来被sql语句的声明引用的</span><br><span class="line"></span><br><span class="line">2、type属性</span><br><span class="line">配置结果集类型，将查询的数据往哪个类型中封装</span><br><span class="line"></span><br><span class="line">3、autoMapping属性的值</span><br><span class="line">	为true时：在字段和属性名称相同时，会进行自动映射。如果不配置，则默认为true。</span><br><span class="line">	为false时：只针对resultMap中已经配置的字段作映射。</span><br></pre></td></tr></table></figure>

<p><strong>子标签：</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1、id子标签</span><br><span class="line">	配置主键的映射关系</span><br><span class="line">2、result子标签</span><br><span class="line">	配置其他普通属性和字段的映射关系</span><br></pre></td></tr></table></figure>





<h2 id="4、动态SQL"><a href="#4、动态SQL" class="headerlink" title="4、动态SQL"></a>4、动态SQL</h2><p>MyBatis 的强大特性之一便是它的动态 SQL。如果你有使用 JDBC 或其它类似框架的经验，你就能体会到根据不同条件拼接 SQL 语句的痛苦。例如拼接时要确保不能忘记添加必要的空格，还要注意去掉列表最后一个列名的逗号。利用动态 SQL 这一特性可以彻底摆脱这种痛苦。</p>
<p>例如，下面需求就会使用到拼接sql语句：</p>
<p>【需求】：查询<strong>男性</strong>用户，<strong>如果输入了用户名，按用户名模糊查询</strong>,如果<strong>没有输入用户名，就查询所有男性用户</strong>。</p>
<p>正常的sql语句：查询男性并且用户名中包含zhang</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://js.hnlyx.top/img/1552033448416.png" alt="1552033448416"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tb_user <span class="keyword">where</span> sex <span class="operator">=</span> &quot;男&quot; <span class="keyword">and</span> user_name <span class="keyword">like</span> <span class="string">&#x27;%zhang%&#x27;</span></span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://js.hnlyx.top/img/1552033532415.png" alt="1552033532415"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tb_user <span class="keyword">where</span>  sex <span class="operator">=</span> &quot;男&quot;  </span><br></pre></td></tr></table></figure>

<pre><code>实现需求时还要判断用户是否输入用户名来做不同的查询要求，而这里似乎没有办法判断是否输入了用户名，因此可以考虑使用动态sql来完成这个功能。



动态 SQL 元素和后面学习的 JSTL 或基于之前学习的类似 XML 的文本处理器相似。在 MyBatis 之前的版本中，有很多元素需要花时间了解。MyBatis 3 开始精简了元素种类，现在只需学习原来一半的元素便可。MyBatis 采用功能强大的 OGNL 的表达式来淘汰其它大部分元素。
</code></pre>
<p>常见标签如下：</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">if：判断   if(1 gt 2)&#123;&#125;</span><br><span class="line">choose (when, otherwise)：分支判断    switch:多选一</span><br><span class="line">trim (where, set)：去除</span><br><span class="line">foreach：循环遍历标签</span><br></pre></td></tr></table></figure>

<p>动态SQL中的业务逻辑判断需要使用到以下运算符： ognl表达式</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">1.   e1 or e2 满足一个即可</span><br><span class="line">2.   e1 and e2 都得满足 </span><br><span class="line">3.    e1 == e2,e1 eq e2 判断是否相等</span><br><span class="line">4.    e1 != e2,e1 neq e2 不相等</span><br><span class="line">5.    e1 lt e2：小于   lt表示less than </span><br><span class="line">6.    e1 lte e2：小于等于，其他gt（大于）,gte（大于等于） gt 表示greater than</span><br><span class="line">7.    e1 in e2 </span><br><span class="line">8.    e1 not in e2</span><br><span class="line">9.    e1 + e2,e1 * e2,e1/e2,e1 - e2,e1<span class="comment">%e2</span></span><br><span class="line">10.   !e,not e：非，求反</span><br><span class="line">11.   e.method(args)调用对象方法</span><br><span class="line">12.   e.property对象属性值</span><br><span class="line">13.   e1[ e2 ]按索引取值，List,数组和Map</span><br><span class="line">14.   @class@method(args)调用类的静态方法</span><br><span class="line">15.   @class@field调用类的静态字段值</span><br></pre></td></tr></table></figure>



<h3 id="1、if标签"><a href="#1、if标签" class="headerlink" title="1、if标签"></a>1、if标签</h3><p>格式：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;判断条件&quot;</span>&gt;</span></span><br><span class="line">   满足条件执行的代码</span><br><span class="line"> <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">说明：</span><br><span class="line"> 1）if标签：判断语句，用于进行逻辑判断的。如果判断条件为true，则执行if标签的文本内容</span><br><span class="line"> 2）test属性：用来编写表达式，支持ognl；</span><br></pre></td></tr></table></figure>

<p>【需求】：查询<strong>男性</strong>用户，<strong>如果输入了用户名，按用户名模糊查询</strong>,如果<strong>没有输入用户名，就查询所有男性用户</strong>。</p>
<p>正常的sql语句：查询男性并且用户名中包含zhang</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://js.hnlyx.top/img/1552033448416.png" alt="1552033448416"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tb_user <span class="keyword">where</span> sex <span class="operator">=</span> &quot;男&quot; <span class="keyword">and</span> user_name <span class="keyword">like</span> <span class="string">&#x27;%zhang%&#x27;</span></span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://js.hnlyx.top/img/1552033532415.png" alt="1552033532415"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tb_user <span class="keyword">where</span>  sex <span class="operator">=</span> &quot;男&quot;  </span><br></pre></td></tr></table></figure>

<pre><code>实现需求时还要判断用户是否输入用户名来做不同的查询要求，而这里似乎没有办法判断是否输入了用户名，因此可以考虑使用动态sql来完成这个功能。

上述动态sql语句部分： and user_name like &#39;%zhang%&#39; 
</code></pre>
<h4 id="1-1、定义接口方法"><a href="#1-1、定义接口方法" class="headerlink" title="1.1、定义接口方法"></a>1.1、定义接口方法</h4><pre><code>在UserMapper接口中，定义如下方法：
</code></pre>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * 根据用户名模糊查询</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@param</span> userName</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"> List&lt;User&gt; <span class="title function_">queryLikeUserName</span><span class="params">(<span class="meta">@Param(&quot;userName&quot;)</span> String userName)</span>;</span><br></pre></td></tr></table></figure>



<h4 id="1-2、编写SQL"><a href="#1-2、编写SQL" class="headerlink" title="1.2、编写SQL"></a>1.2、编写SQL</h4><pre><code>在UserMapper.xml文件中编写与方法名同名的sql语句：
</code></pre>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;queryLikeUserName&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;user&quot;</span>&gt;</span></span><br><span class="line">     select * from user where sex=&#x27;男&#x27;</span><br><span class="line">     <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;userName!=null and userName.trim()!=&#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">         and username like &#x27;%$&#123;userName&#125;%&#x27;</span><br><span class="line">     <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>【注】<code>&lt;if&gt;</code> 判断中：</p>
<p>1、if标签：用来判断；</p>
<p>2、test属性：使用OGNL表达式，完成具体的判断业务逻辑；</p>
<p><strong>3、这里使用的字符串拼接，所以这里不能是#取值，只能使用$取值，否则会报错</strong></p>
<h4 id="1-3、测试"><a href="#1-3、测试" class="headerlink" title="1.3、测试"></a>1.3、测试</h4><p>【userName有值】</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:/Users/Administrator/Desktop/Hexo/gift95.github.io/source/_posts/img/image-20200606165900500.png" alt="image-20200606165900500"></p>
<p>对应的SQL语句是：select * from user where sex&#x3D;”男” and username like ‘%孙%’ </p>
<p>【userName没有值】</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:/Users/Administrator/Desktop/Hexo/gift95.github.io/source/_posts/img/image-20200606170024096.png" alt="image-20200606170024096"></p>
<p>对应的SQL语句是：select * from user where sex&#x3D;”男” </p>
<p>【小结】</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1、if标签：用来在sql中处理判断是否成立的情况；</span><br><span class="line">2、属性：test中书写OGNL表达式，如果结果为true，if标签的文本中的内容会被拼接到SQL中，反之不会被拼接到SQL中；</span><br><span class="line">3、if标签的应用场景：适用于 二选一 </span><br></pre></td></tr></table></figure>



<h3 id="2、choose，when，otherwise"><a href="#2、choose，when，otherwise" class="headerlink" title="2、choose，when，otherwise"></a>2、choose，when，otherwise</h3><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">choose标签：分支选择（多选一，遇到成立的条件即停止）</span><br><span class="line">	when子标签：编写条件，不管有多少个when条件，一旦其中一个条件成立，后面的when条件都不执行。</span><br><span class="line">           test属性：编写ognl表达式</span><br><span class="line">	otherwise子标签：当所有条件都不满足时，才会执行该条件。</span><br></pre></td></tr></table></figure>



<p> 需求：</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">编写一个查询方法，设置两个参数，一个是用户名，一个是住址。</span><br><span class="line"></span><br><span class="line">根据用户名或者住址查询所有男性用户:</span><br><span class="line">	如果输入了用户名则按照用户名模糊查找，</span><br><span class="line">	否则就按照住址查找，两个条件只能成立一个，</span><br><span class="line">	如果都不输入就查找用户名为“孙悟空”的用户。</span><br></pre></td></tr></table></figure>

<p>【需求分析】</p>
<p>1、查询所有男性用户,如果输入了用户名则按照用户名模糊查找;</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span>  <span class="keyword">user</span> <span class="keyword">WHERE</span>  sex <span class="operator">=</span> &quot;男&quot; <span class="keyword">AND</span>  username <span class="keyword">LIKE</span>  <span class="string">&#x27;%孙%&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>2、查询所有男性用户,如果输入了住址则按照住址查询；</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span>  <span class="keyword">user</span> <span class="keyword">WHERE</span>  sex <span class="operator">=</span> &quot;男&quot; <span class="keyword">AND</span>  address <span class="operator">=</span> &quot;花果山水帘洞&quot;;</span><br></pre></td></tr></table></figure>

<p>3、查询所有男性用户，如果都不输入就查找用户名为“孙悟空”的用户。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span>  <span class="keyword">user</span> <span class="keyword">WHERE</span>  sex <span class="operator">=</span> &quot;男&quot; <span class="keyword">AND</span> username <span class="operator">=</span> <span class="string">&#x27;孙悟空&#x27;</span>;</span><br></pre></td></tr></table></figure>



<h4 id="2-1、定义接口方法"><a href="#2-1、定义接口方法" class="headerlink" title="2.1、定义接口方法"></a>2.1、定义接口方法</h4><p>在UserMapper接口中，定义接口方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">   查询用户名或者地址</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">List&lt;User&gt; <span class="title function_">queryByUserNameOrAddress</span><span class="params">(<span class="meta">@Param(&quot;userName&quot;)</span> String userName, <span class="meta">@Param(&quot;address&quot;)</span> String address)</span>;</span><br></pre></td></tr></table></figure>



<h4 id="2-2、编写SQL"><a href="#2-2、编写SQL" class="headerlink" title="2.2、编写SQL"></a>2.2、编写SQL</h4><p>在UserMapper.xml中编写对应的SQL语句</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">        根据用户名或者住址查询所有男性用户:</span></span><br><span class="line"><span class="comment">            如果输入了用户名则按照用户名模糊查找，</span></span><br><span class="line"><span class="comment">            否则就按照住址查找，两个条件只能成立一个，</span></span><br><span class="line"><span class="comment">            如果都不输入就查找用户名为“孙悟空”的用户。</span></span><br><span class="line"><span class="comment">  --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;queryByUserNameOrAddress&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;user&quot;</span>&gt;</span></span><br><span class="line">        select * from user where sex=&#x27;男&#x27;</span><br><span class="line">        <span class="tag">&lt;<span class="name">choose</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">&quot;userName!=null and userName.trim()!=&#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">                and username like &#x27;%$&#123;userName&#125;%&#x27;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">when</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">&quot;address!=null and address.trim()!=&#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">                and address = #&#123;address&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">when</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">otherwise</span>&gt;</span></span><br><span class="line">                and username=&#x27;孙悟空&#x27;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">otherwise</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">choose</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="2-3、测试"><a href="#2-3、测试" class="headerlink" title="2.3、测试"></a>2.3、测试</h4><p>编写测试类，对这个方法进行测试：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">queryByUserNameOrAddress</span><span class="params">()</span>&#123;</span><br><span class="line">    List&lt;User&gt; userList = userMapper.queryByUserNameOrAddress(<span class="string">&quot;&quot;</span>, <span class="literal">null</span>);</span><br><span class="line">    System.out.println(<span class="string">&quot;userList = &quot;</span> + userList);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>【小结】</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1、choose，when，otherwise标签组合的作用类似于java中的switch语句，使用于多选一；</span><br></pre></td></tr></table></figure>



<h3 id="3、where"><a href="#3、where" class="headerlink" title="3、where"></a>3、where</h3><p> where标签：拼接多条件查询时 1、能够添加where关键字； 2、能够去除多余的and或者or关键字</p>
<p>案例：按照如下条件查询所有用户，</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">如果输入了用户名按照用户名进行查询，</span><br><span class="line">如果输入住址，按住址进行查询，</span><br><span class="line">如果两者都输入，两个条件都要成立。</span><br></pre></td></tr></table></figure>

<p>【需求分析】</p>
<p>1、如果输入了用户名按照用户名进行查询，</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span>  <span class="keyword">user</span> <span class="keyword">WHERE</span> user_name <span class="operator">=</span> <span class="string">&#x27;孙悟空&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>2、如果输入住址，按住址进行查询，</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span>  <span class="keyword">user</span> <span class="keyword">WHERE</span> address<span class="operator">=</span><span class="string">&#x27;花果山水帘洞&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>3、如果两者都输入，两个条件都要成立。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span>  <span class="keyword">user</span> <span class="keyword">WHERE</span> user_name <span class="operator">=</span> <span class="string">&#x27;孙悟空&#x27;</span> <span class="keyword">AND</span> address<span class="operator">=</span><span class="string">&#x27;花果山水帘洞&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h4 id="3-1、定义接口方法"><a href="#3-1、定义接口方法" class="headerlink" title="3.1、定义接口方法"></a>3.1、定义接口方法</h4><p>在UserMapper接口中定义如下方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">List&lt;User&gt; <span class="title function_">queryByUserNameAndAge</span><span class="params">(<span class="meta">@Param(&quot;userName&quot;)</span> String userName, <span class="meta">@Param(&quot;address&quot;)</span> String address)</span>;</span><br></pre></td></tr></table></figure>



<h4 id="3-2、编写SQL"><a href="#3-2、编写SQL" class="headerlink" title="3.2、编写SQL"></a>3.2、编写SQL</h4><p>在UserMapper.xml中编写SQL</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">       如果输入了用户名按照用户名进行查询，</span></span><br><span class="line"><span class="comment">       如果输入住址，按住址进行查询，</span></span><br><span class="line"><span class="comment">       如果两者都输入，两个条件都要成立。</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">       说明：如果按照如下写sql语句会有问题，假设用户名username是空，那么用户名的sql语句不参与条件，此时</span></span><br><span class="line"><span class="comment">       sql语句就会变为：SELECT * FROM  user where AND address = #&#123;address&#125;</span></span><br><span class="line"><span class="comment">       where后面直接书写了and显然不满足sql语句语法，这里会报错</span></span><br><span class="line"><span class="comment">       我们可以使用where标签解决上述问题：</span></span><br><span class="line"><span class="comment">            where标签：拼接多条件查询时 1、能够添加where关键字； 2、能够去除多余的and或者or关键字</span></span><br><span class="line"><span class="comment">   --&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- &lt;select id=&quot;queryByUserNameAndAge&quot; resultType=&quot;user&quot;&gt;</span></span><br><span class="line"><span class="comment">       SELECT * FROM  user where</span></span><br><span class="line"><span class="comment">           &lt;if test=&quot;userName != null and userName.trim()!=&#x27;&#x27;&quot;&gt;</span></span><br><span class="line"><span class="comment">               username = #&#123;userName&#125;</span></span><br><span class="line"><span class="comment">           &lt;/if&gt;</span></span><br><span class="line"><span class="comment">           &lt;if test=&quot;address!=null and address.trim()!=&#x27;&#x27;&quot;&gt;</span></span><br><span class="line"><span class="comment">               AND address = #&#123;address&#125;</span></span><br><span class="line"><span class="comment">           &lt;/if&gt;</span></span><br><span class="line"><span class="comment">   &lt;/select&gt;--&gt;</span></span><br><span class="line">   <span class="comment">&lt;!-- SELECT * FROM user WHERE address = ?</span></span><br><span class="line"><span class="comment">       where子标签将and去掉了</span></span><br><span class="line"><span class="comment">   --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;queryByUserNameAndAge&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;user&quot;</span>&gt;</span></span><br><span class="line">       SELECT * FROM  user</span><br><span class="line">       <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;userName != null and userName.trim()!=&#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">               username = #&#123;userName&#125;</span><br><span class="line">           <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;address!=null and address.trim()!=&#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">               AND address = #&#123;address&#125;</span><br><span class="line">           <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>说明：</p>
<p>1.说明：如果按照如下写sql语句会有问题，假设用户名username是空，那么用户名的sql语句不参与条件，此时<br>        sql语句就会变为：SELECT * FROM  user where AND address &#x3D; #{address}<br>        where后面直接书写了and显然不满足sql语句语法，这里会报错<br>        我们可以使用where标签解决上述问题：<br>             where标签：拼接多条件查询时 1、能够添加where关键字； 2、能够去除多余的and或者or关键字</p>
<p>2.SELECT * FROM user WHERE address &#x3D; ?<br>       where子标签将and去掉了</p>
<h4 id="3-3、测试"><a href="#3-3、测试" class="headerlink" title="3.3、测试"></a>3.3、测试</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">queryByUserNameAndAge</span><span class="params">()</span> &#123;</span><br><span class="line">        List&lt;User&gt; userList = userMapper.queryByUserNameAndAge(<span class="string">&quot;&quot;</span>, <span class="string">&quot;花果山水帘洞&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;userList = &quot;</span> + userList);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://js.hnlyx.top/img/image-20200606213846118.png" alt="image-20200606213846118"></p>
<p>只传入住址，此时where子标签去掉了and.</p>
<p>【小结】</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1、&lt;where&gt;标签作用：用于拼接多选一或者同时成立的SQL情况；</span><br><span class="line">2、&lt;where&gt;还会根据情况，动态的去掉SQL语句中的AND或者or；</span><br></pre></td></tr></table></figure>



<h3 id="4、set"><a href="#4、set" class="headerlink" title="4、set"></a>4、set</h3><p>set标签：在update语句中,可以自动添加一个set关键字，并且会将动态sql最后多余的逗号去除。</p>
<p>案例：修改用户信息，如果参数user中的某个属性为null，则不修改。</p>
<p>如果在正常编写更新语句时，如下：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://js.hnlyx.top/img/image-20200606220512579.png" alt="image-20200606220512579"></p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">update</span> <span class="keyword">user</span> <span class="keyword">SET</span> username <span class="operator">=</span> ?, birthday<span class="operator">=</span>?, sex<span class="operator">=</span>?, <span class="keyword">where</span> id <span class="operator">=</span> ? </span><br></pre></td></tr></table></figure>

<p>那么一旦在传递的参数中没有address，此时生成的sql语句就会因为多了一个逗号而报错。</p>
<h4 id="4-1、定义接口方法"><a href="#4-1、定义接口方法" class="headerlink" title="4.1、定义接口方法"></a>4.1、定义接口方法</h4><p>在UserMapper接口中定义如下方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> <span class="title function_">updateSelectiveUser</span><span class="params">(User user)</span>;</span><br></pre></td></tr></table></figure>



<h4 id="4-2、编写SQL"><a href="#4-2、编写SQL" class="headerlink" title="4.2、编写SQL"></a>4.2、编写SQL</h4><p>在UserMapper.xml文件中编写如下SQL:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">&lt;!--选择性地对user数据进行修改--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">&quot;updateSelectiveUser&quot;</span>&gt;</span></span><br><span class="line">     update user</span><br><span class="line">     <span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;username != null and username.trim()!=&#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">             username = #&#123;username&#125;,</span><br><span class="line">         <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;birthday != null&quot;</span>&gt;</span></span><br><span class="line">             birthday=#&#123;birthday&#125;,</span><br><span class="line">         <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;sex != null and sex.trim()!=&#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">             sex=#&#123;sex&#125;,</span><br><span class="line">         <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;address != null and address.trim()!=&#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">             address=#&#123;address&#125;</span><br><span class="line">         <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">     where id = #&#123;id&#125;</span><br><span class="line"> <span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h4 id="4-3、测试"><a href="#4-3、测试" class="headerlink" title="4.3、测试"></a>4.3、测试</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">updateSelectiveUser</span><span class="params">()</span> &#123;</span><br><span class="line">       <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">       user.setUsername(<span class="string">&quot;锁哥1&quot;</span>);</span><br><span class="line">       user.setBirthday(<span class="keyword">new</span> <span class="title class_">Date</span>());</span><br><span class="line">       user.setSex(<span class="string">&quot;男&quot;</span>);</span><br><span class="line">       user.setAddress(<span class="string">&quot;&quot;</span>);</span><br><span class="line"></span><br><span class="line">       user.setId(<span class="number">7</span>);</span><br><span class="line">       userMapper.updateSelectiveUser(user);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<p>【结果】</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">update</span> <span class="keyword">user</span> <span class="keyword">SET</span> username <span class="operator">=</span> ?, birthday<span class="operator">=</span>?, sex<span class="operator">=</span>? <span class="keyword">where</span> id <span class="operator">=</span> ? </span><br></pre></td></tr></table></figure>



<p>【小结】</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1、&lt;set&gt;标签替代了sql语句中的set关键字；</span><br><span class="line">2、&lt;set&gt;标签还能把sql中多余的,去掉；</span><br></pre></td></tr></table></figure>



<h3 id="5、foreach"><a href="#5、foreach" class="headerlink" title="5、foreach"></a>5、foreach</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">foreach标签：遍历集合或者数组</span><br><span class="line"><span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">&quot;集合名或者数组名&quot;</span> <span class="attr">item</span>=<span class="string">&quot;元素&quot;</span> <span class="attr">separator</span>=<span class="string">&quot;标签分隔符&quot;</span> <span class="attr">open</span>=<span class="string">&quot;以什么开始&quot;</span> <span class="attr">close</span>=<span class="string">&quot;以什么结束&quot;</span>&gt;</span></span><br><span class="line">   #&#123;元素&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line">	collection属性：接收的集合或者数组,集合名或者数组名</span><br><span class="line">	item属性：集合或者数组参数中的每一个元素 </span><br><span class="line">	separator属性：标签分隔符 </span><br><span class="line">	open属性：以什么开始 </span><br><span class="line">	close属性：以什么结束</span><br></pre></td></tr></table></figure>

<p>需求：按照id值是1，2，3来查询用户数据；</p>
<h4 id="5-1、定义接口方法"><a href="#5-1、定义接口方法" class="headerlink" title="5.1、定义接口方法"></a>5.1、定义接口方法</h4><p>在UserMapper接口中定义如下方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">List&lt;User&gt; <span class="title function_">queryByIds</span><span class="params">(<span class="meta">@Param(&quot;arrIds&quot;)</span> Integer[] arrIds)</span>;</span><br></pre></td></tr></table></figure>

<p><strong>这里一定加@Param(“arrIds”)，否则报错</strong></p>
<h4 id="5-2、编写SQL"><a href="#5-2、编写SQL" class="headerlink" title="5.2、编写SQL"></a>5.2、编写SQL</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--根据多个id值查询--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;queryByIds&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;user&quot;</span>&gt;</span></span><br><span class="line">       SELECT * FROM  user WHERE id IN</span><br><span class="line">       <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">&quot;arrIds&quot;</span> <span class="attr">item</span>=<span class="string">&quot;ID&quot;</span> <span class="attr">separator</span>=<span class="string">&quot;,&quot;</span> <span class="attr">open</span>=<span class="string">&quot;(&quot;</span> <span class="attr">close</span>=<span class="string">&quot;)&quot;</span>&gt;</span></span><br><span class="line">           #&#123;ID&#125;</span><br><span class="line">       <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="5-3、测试"><a href="#5-3、测试" class="headerlink" title="5.3、测试"></a>5.3、测试</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">queryByIds</span><span class="params">()</span> &#123;</span><br><span class="line">    Integer[] arrIds = &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>&#125;;</span><br><span class="line">    List&lt;User&gt; userList = userMapper.queryByIds(arrIds);</span><br><span class="line">    System.out.println(<span class="string">&quot;userList = &quot;</span> + userList);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://js.hnlyx.top/img/1551344599980.png" alt="1551344599980"></p>
<p>【小结】</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;foreach&gt;标签的作用：用于对查询参数进行遍历取值；</span><br></pre></td></tr></table></figure>



<h3 id="6、小结"><a href="#6、小结" class="headerlink" title="6、小结"></a>6、小结</h3><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">If标签：条件判断</span><br><span class="line">	test属性：编写ognl表达式</span><br><span class="line"></span><br><span class="line">where标签：用于sql动态条件拼接，添加where关键字，可以将动态sql多余的第一个and或者or去除。</span><br><span class="line"></span><br><span class="line">set标签: 用于更新语句的拼接，添加set关键字，并可以将动态sql中多余的逗号去除</span><br><span class="line"></span><br><span class="line">foreach标签：用于遍历参数中的数组或者集合</span><br><span class="line">	collection属性：参数中的数组或者集合</span><br><span class="line">	item属性：表示数组或者集合中的某个元素，取出数据使用<span class="params">#</span>&#123;item的属性值&#125;</span><br><span class="line">	separator属性：分隔符</span><br><span class="line">	open:以什么开始</span><br><span class="line">	close:以什么结束</span><br></pre></td></tr></table></figure>







<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">一、映射文件配置</span><br><span class="line">	【1】作用：配置sql相关信息 </span><br><span class="line">			 1、CRUD四类标签：</span><br><span class="line">			 2、sql标签：sql片段</span><br><span class="line">			 3、resultMap：</span><br><span class="line">	【2】CRUD四类标签：</span><br><span class="line">			增： <span class="tag">&lt;<span class="name">insert</span>&gt;</span><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line">			删： <span class="tag">&lt;<span class="name">delete</span>&gt;</span><span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br><span class="line">			改：<span class="tag">&lt;<span class="name">update</span>&gt;</span><span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br><span class="line">			查：<span class="tag">&lt;<span class="name">select</span>&gt;</span><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	【3】入参相关：<span class="tag">&lt;<span class="name">select</span> <span class="attr">resultType</span>=<span class="string">&quot;User&quot;</span> <span class="attr">paramType</span>=<span class="string">&quot;int&quot;</span>&gt;</span></span><br><span class="line">      				SELECT * FROM user WHERE id = #&#123;id&#125;</span><br><span class="line">				<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">			</span><br><span class="line">		paramType：设置传入的参数的类型，可以省略</span><br><span class="line">		insert语句相关：自增主键回填--数据插入到数据库之后，返回这条数据在数据库中的主键值</span><br><span class="line">			【1】子标签：<span class="tag">&lt;<span class="name">selectKey</span>&gt;</span><span class="tag">&lt;/<span class="name">selectKey</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">selectKey</span> <span class="attr">keyColumn</span>=<span class="string">&quot;id&quot;</span> <span class="attr">keyProperty</span>=<span class="string">&quot;id&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;int&quot;</span> <span class="attr">order</span>=<span class="string">&quot;AFTER&quot;</span>&gt;</span></span><br><span class="line">            SELECT LAST_INSERT_ID() ;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">selectKey</span>&gt;</span></span><br><span class="line">			【2】属性：</span><br><span class="line">				useGeneratedKeys=&quot;true&quot; keyColumn=&quot;id&quot; keyProperty=&quot;id&quot; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	【4】sql参数传入：</span><br><span class="line">			能够接收的参数类型： 基本类型数据，pojo，map</span><br><span class="line"></span><br><span class="line">	【5】传入基本类型数据：string,int</span><br><span class="line">		 单个数据传入： queryById(Integer id)        WHERE id = #&#123;id&#125;</span><br><span class="line">		多个数据传入：queryByNameAndSex(String name,String sex):  </span><br><span class="line">						WHERE username=#&#123;&#125; and sex= #&#123;&#125;</span><br><span class="line">		最佳实践：命名参数取值  </span><br><span class="line">				queryByNameAndSex(@Param(&quot;name&quot;)String name,@Param(&quot;sex&quot;)String sex):  </span><br><span class="line">				WHERE username=#&#123;name&#125; and sex= #&#123;sex&#125;</span><br><span class="line"></span><br><span class="line">	【6】传入pojo和map数据：</span><br><span class="line">			pojo： User&#123;id,username&#125;   #&#123;username&#125;</span><br><span class="line">			map:  Map&lt;Key,Value&gt;      #&#123;key&#125;</span><br><span class="line">	</span><br><span class="line">     【7】映射文件中sql语句取值： #&#123;&#125;  $&#123;&#125;</span><br><span class="line">              相同点：都能够获取命名参数值</span><br><span class="line">              不同点：</span><br><span class="line">              		#&#123;&#125; 取值使用预编译方式设置参数</span><br><span class="line">              		$&#123;&#125; 直接标签获取的参数拼接到sql语句中</span><br><span class="line">           最佳实践： 获取查询参数，防止SQL注入 使用  #&#123;&#125;取值</span><br><span class="line">              </span><br><span class="line">      【8】$&#123;&#125;应用场景： 拼接SQL语句</span><br><span class="line">       </span><br><span class="line">       </span><br><span class="line">       【9】sql返回值处理：</span><br><span class="line">              resultType:基本类型数据，pojo，map</span><br><span class="line">              	基本类型数据： resultType=&quot;int&quot;</span><br><span class="line">              	pojo类型：</span><br><span class="line">              		单个pojo，多个pojo：   resultType=&quot;pojo&quot;</span><br><span class="line">              	map：</span><br><span class="line">              		单条数据：map  默认    resulteType=&quot;map&quot;</span><br><span class="line">              		多条数据：map    @MapKey(&quot;id&quot;)</span><br><span class="line">             </span><br><span class="line">              resultMap:</span><br><span class="line">				【1】设置数据库的列名  和  实体类的属性名之间  映射关系</span><br><span class="line">              	 【2】多表关联配置：</span><br><span class="line">              </span><br><span class="line">         【10】动态sql：</span><br><span class="line">              	判断： if，分支</span><br><span class="line">              	trim： where，set</span><br><span class="line">              	foreach：遍历</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="高级查询"><a href="#高级查询" class="headerlink" title="高级查询"></a>高级查询</h2><h3 id="1、一对一查询"><a href="#1、一对一查询" class="headerlink" title="1、一对一查询"></a>1、一对一查询</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">association：配置关联对象（User）的映射关系</span><br><span class="line"> &lt;association property=<span class="string">&quot;user&quot;</span> javaType=<span class="string">&quot;User&quot;</span> autoMapping=<span class="string">&quot;true&quot;</span>&gt;</span><br><span class="line">           </span><br><span class="line">  &lt;/association&gt;</span><br><span class="line">	属性：</span><br><span class="line">		property：关联对象在主表实体类中的属性名；property=<span class="string">&quot;user&quot;</span> 表示在Order类中的引用的User类的对象		   成员变量名</span><br><span class="line">		javaType：关联对象的类型；javaType=<span class="string">&quot;User&quot;</span> 表示引用的user对象属于User类型</span><br></pre></td></tr></table></figure>



<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">映射文件</span></span><br><span class="line"><span class="comment">namespace 指定接口的类全名</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.itheima.sh.dao.OrderMapper&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">        1.autoMapping=&quot;true&quot; 表示只需要给当前表的id然后自动映射当前表的其他列值到</span></span><br><span class="line"><span class="comment">        对应实体类的属性中，这属于偷懒行为，开发中我们最好都书写出来</span></span><br><span class="line"><span class="comment">        2.id标签表示id的映射关系</span></span><br><span class="line"><span class="comment">        3.result标签表示其他列和pojo类的属性映射关系</span></span><br><span class="line"><span class="comment">        4.一对一映射关系使用子标签association来表示引用的另一个pojo类的对象</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;orderAndUserResultRelative&quot;</span> <span class="attr">type</span>=<span class="string">&quot;Order&quot;</span> <span class="attr">autoMapping</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--主表主键--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--关联关系--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">            1.property=&quot;user&quot; 表示在Order类中的引用的User类的对象成员变量名</span></span><br><span class="line"><span class="comment">            2.javaType=&quot;User&quot; 表示引用的user对象属于User类型</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">&quot;user&quot;</span> <span class="attr">javaType</span>=<span class="string">&quot;User&quot;</span> <span class="attr">autoMapping</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--从表主键--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span>/&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--&lt;result column=&quot;user_name&quot; property=&quot;userName&quot;/&gt;--&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">association</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--多表关联查询：一对一--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;queryOrderAndUserByOrderNumber2&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;orderAndUserResultRelative&quot;</span>&gt;</span></span><br><span class="line">        SELECT</span><br><span class="line">            *</span><br><span class="line">        FROM</span><br><span class="line">            tb_order tbo</span><br><span class="line">            INNER JOIN tb_user tbu ON tbo.user_id = tbu.id</span><br><span class="line">        WHERE</span><br><span class="line">            tbo.order_number = #&#123;orderNumber&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>说明：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>、由于queryOrderAndUserByOrderNumber2查询的结果Order对象中需要封装User信息，所以返回值不能够再使用单纯的resultType来操作；</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>、定义resultMap进行关联查询的配置，其中：</span><br><span class="line">	属性：</span><br><span class="line">		id：标识这个resultMap；</span><br><span class="line">		type：返回的结果类型</span><br><span class="line">    	autoMapping=<span class="string">&quot;true&quot;</span>： 表示只需要给当前表的id然后自动映射当前表的其他列值到对应实体类的属性中，这		  属于偷懒行为，开发中我们最好都书写出来</span><br><span class="line">	子元素：</span><br><span class="line">		id：主表主键映射</span><br><span class="line">		result：主表普通字段的映射</span><br><span class="line">		association:关联对象的映射配置</span><br><span class="line">		</span><br><span class="line"><span class="number">3</span>、association：配置关联对象（User）的映射关系</span><br><span class="line">	属性：</span><br><span class="line">		property：关联对象在主表实体类中的属性名；property=<span class="string">&quot;user&quot;</span> 表示在Order类中的引用的User类的对象		   成员变量名</span><br><span class="line">		javaType：关联对象的类型；javaType=<span class="string">&quot;User&quot;</span> 表示引用的user对象属于User类型</span><br></pre></td></tr></table></figure>

<h5 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h5><p>通过上述测试结果，我们发现User的id是错误的，不是3，正确结果是1：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://js.hnlyx.top/img/image-20200607103247424-164204273873711.png" alt="image-20200607103247424"></p>
<p>因为tb_user表的主键是id，tb_order的主键也是id。查询的结果中有两列相同的id字段。在将查询结果封装到实体类的过程中就会封装错误。</p>
<p>注意：user表查询的是id不是id1,由于SQLyog图形化界面显示的原因。可以在cmd窗口查看结果：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://js.hnlyx.top/img/image-20200607104119140-164204273873712.png" alt="image-20200607104119140"></p>
<p>【解决方案】</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1、建议将所要查询的所有字段显示地写出来；</span><br><span class="line">2、将多表关联查询结果中，相同的字段名取不同的别名；</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://js.hnlyx.top/img/image-20200607104753543-164204273873713.png" alt="image-20200607104753543"></p>
<p>resultMap中应该如下配置：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://js.hnlyx.top/img/image-20200607105105346-164204273873715.png" alt="image-20200607105105346"></p>
<p>【正确结果】</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://js.hnlyx.top/img/image-20200607105210595-164204273873716.png" alt="image-20200607105210595"></p>
<h5 id="【小结】-3"><a href="#【小结】-3" class="headerlink" title="【小结】"></a>【小结】</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">一对一关联查询：</span><br><span class="line">1、需要在Order实体类中关联User对象；最终将数据封装到Order中；</span><br><span class="line">2、在OrderMapper.xml文件中书写关联语句并配置关系；</span><br><span class="line">3、关联关系配置：</span><br><span class="line">	    <span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;orderAndUserResultRelative&quot;</span> <span class="attr">type</span>=<span class="string">&quot;Order&quot;</span> <span class="attr">autoMapping</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--主表主键--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">&quot;oid&quot;</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span>/&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--关联关系--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">&quot;user&quot;</span> <span class="attr">javaType</span>=<span class="string">&quot;User&quot;</span> <span class="attr">autoMapping</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--从表主键--&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">&quot;uid&quot;</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">association</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="2、一对多查询"><a href="#2、一对多查询" class="headerlink" title="2、一对多查询"></a>2、一对多查询</h3><p>在<strong>UserMapper.xml</strong>文件中编写SQL语句完成一对多的关联查询；</p>
<p>说明：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">1.一对多使用collection子标签进行关联多方Order</span><br><span class="line">  <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">&quot;类中引用多方的成员变量名&quot;</span> <span class="attr">javaType</span>=<span class="string">&quot;存放多方容器的类型&quot;</span> <span class="attr">ofType</span>=<span class="string">&quot;多方类型&quot;</span> <span class="attr">autoMapping</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line">2.属性：</span><br><span class="line">    1）property=&quot;orders&quot; 这里的orders表示User类的成员变量orders</span><br><span class="line">    2）javaType=&quot;List&quot; 表示User类的成员变量orders存储的Order对象使用的类型，这里是List 一般不书写</span><br><span class="line">    3) ofType=&quot;Order&quot; 表示List集合中存储数据的类型 Order</span><br><span class="line">3.一定要记住这里给user表的id起别名是uid,order表的id起别名是oid.在resultMap标签的id子标签中的column属性值书写对应的uid和oid.</span><br></pre></td></tr></table></figure>



<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--自定义结果集--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;oneToManyResult&quot;</span> <span class="attr">type</span>=<span class="string">&quot;User&quot;</span> <span class="attr">autoMapping</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--User的主键--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">&quot;uid&quot;</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--Order关联映射--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">        1.一对多使用collection子标签进行关联多方Order</span></span><br><span class="line"><span class="comment">        2.属性：</span></span><br><span class="line"><span class="comment">            1）property=&quot;orders&quot; 这里的orders表示User类的成员变量orders</span></span><br><span class="line"><span class="comment">            2）javaType=&quot;List&quot; 表示User类的成员变量orders存储的Order对象使用的类型，这里是List，可以不配置</span></span><br><span class="line"><span class="comment">            3) ofType=&quot;Order&quot; 表示List集合中存储数据的类型 Order</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">&quot;orders&quot;</span> <span class="attr">javaType</span>=<span class="string">&quot;List&quot;</span> <span class="attr">ofType</span>=<span class="string">&quot;Order&quot;</span> <span class="attr">autoMapping</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--Order的主键--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">&quot;oid&quot;</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--根据用户ID查询用户及其订单数据--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;oneToManyQuery&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;oneToManyResult&quot;</span>&gt;</span></span><br><span class="line">    SELECT</span><br><span class="line">        tbo.id as oid,</span><br><span class="line">        tbo.order_number,</span><br><span class="line">        tbu.id as uid,</span><br><span class="line">        tbu.user_name,</span><br><span class="line">        tbu.password,</span><br><span class="line">        tbu.name,</span><br><span class="line">        tbu.age,</span><br><span class="line">        tbu.sex</span><br><span class="line">    FROM</span><br><span class="line">        tb_user tbu</span><br><span class="line">        INNER JOIN tb_order tbo ON tbu.id = tbo.user_id</span><br><span class="line">    WHERE</span><br><span class="line">        tbu.id = #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在用户的测试类中</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MybatisTest01</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">UserMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@BeforeClass</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">beforeClass</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">//1.构建SessionFactory</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">resouce</span> <span class="operator">=</span> <span class="string">&quot;mybatis-config.xml&quot;</span>;</span><br><span class="line">        <span class="type">InputStream</span> <span class="variable">is</span> <span class="operator">=</span> Resources.getResourceAsStream(resouce);</span><br><span class="line">        <span class="type">SqlSessionFactory</span> <span class="variable">build</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SqlSessionFactoryBuilder</span>().build(is);</span><br><span class="line">        <span class="comment">//2.获取session</span></span><br><span class="line">        <span class="type">SqlSession</span> <span class="variable">sqlSession</span> <span class="operator">=</span> build.openSession(<span class="literal">true</span>);</span><br><span class="line">        <span class="comment">//3.获取接口对象</span></span><br><span class="line">        mapper = sqlSession.getMapper(UserMapper.class);</span><br><span class="line">    &#125;  </span><br><span class="line">	<span class="comment">//根据用户ID查询用户及其订单数据</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">oneToManyQuery</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> mapper.oneToManyQuery(<span class="number">1L</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;user = &quot;</span> + user);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://js.hnlyx.top/img/image-20200607124912217-164204273873718.png" alt="image-20200607124912217"></p>
<h5 id="【小结】-4"><a href="#【小结】-4" class="headerlink" title="【小结】"></a>【小结】</h5><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">一对多关系配置：</span><br><span class="line">1、在对象中添加映射关系；</span><br><span class="line">2、编写接口方法，编写SQL；</span><br><span class="line">3、编写resultMap处理数据库字段和实体类之间数据的封装；</span><br></pre></td></tr></table></figure>

<h2 id="高级查询小结"><a href="#高级查询小结" class="headerlink" title="高级查询小结"></a>高级查询小结</h2><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">resutlType无法帮助我们自动的去完成映射，所以只有使用resultMap手动的进行映射</span><br><span class="line">resultMap: </span><br><span class="line">	属性：</span><br><span class="line">        type 结果集对应的数据类型  Order</span><br><span class="line">        id 唯一标识，被引用的时候，进行指定</span><br><span class="line">        autoMapping 开启自动映射</span><br><span class="line">        extends 继承</span><br><span class="line">	子标签：</span><br><span class="line">	 id:配置id属性</span><br><span class="line">	 result:配置其他属性</span><br><span class="line">      association：配置一对一的映射</span><br><span class="line">          property 定义对象的属性名</span><br><span class="line">          javaType 属性的类型</span><br><span class="line">          autoMapping 开启自动映射</span><br><span class="line">      collection：配置一对多的映射</span><br><span class="line">          property 定义对象的属性名</span><br><span class="line">          javaType 集合的类型</span><br><span class="line">          ofType 集合中的元素类型 泛型</span><br><span class="line">  		  autoMapping 开启自动映射</span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://www.hnlyx.top">Yxliu</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://www.hnlyx.top/2022/12/06/a8587907.html">https://www.hnlyx.top/2022/12/06/a8587907.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://www.hnlyx.top" target="_blank">Yxliu's Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/MyBatis/">MyBatis</a></div><div class="post_share"><div class="social-share" data-image="https://api.ixiaowai.cn/gqapi/gqapi.php" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/12/07/91c8a1f4.html"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://api.ixiaowai.cn/gqapi/gqapi.php" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Vue简单学习</div></div></a></div><div class="next-post pull-right"><a href="/2022/12/05/f8d5cfbe.html"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://api.ixiaowai.cn/gqapi/gqapi.php" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">shell学习</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Yxliu</div><div class="author-info__description">一个半路出家的程序员</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">15</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">11</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">2</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/gift95"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="mailto:851046264@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog<br/>记载和分享在日常的点点滴滴！</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#mybatis%E6%98%A0%E5%B0%84%E6%96%87%E4%BB%B6%E9%85%8D%E7%BD%AE"><span class="toc-number">1.</span> <span class="toc-text">mybatis映射文件配置</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1%E3%80%81%E4%BC%A0%E5%85%A5%E7%9A%84%E5%8F%82%E6%95%B0"><span class="toc-number">1.1.</span> <span class="toc-text">1、传入的参数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%901%E3%80%91parameterType"><span class="toc-number">1.1.1.</span> <span class="toc-text">【1】parameterType</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%902%E3%80%91%E8%87%AA%E5%A2%9E%E4%B8%BB%E9%94%AE%E5%9B%9E%E5%A1%AB%EF%BC%88%E4%BA%86%E8%A7%A3%EF%BC%89"><span class="toc-number">1.1.2.</span> <span class="toc-text">【2】自增主键回填（了解）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0%E4%B8%80%EF%BC%9A%E4%BD%BF%E7%94%A8insert%E6%A0%87%E7%AD%BE%E7%9A%84%E5%AD%90%E6%A0%87%E7%AD%BEselectKey%E5%AE%9E%E7%8E%B0%EF%BC%9B-%E8%87%AA%E5%AD%A6%EF%BC%8C%E4%BA%86%E8%A7%A3%EF%BC%8C%E4%BD%BF%E7%94%A8%E4%B8%8D%E5%A4%9A"><span class="toc-number">1.1.2.1.</span> <span class="toc-text">实现一：使用insert标签的子标签selectKey实现；(自学，了解，使用不多)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0%E4%BA%8C%EF%BC%9A%E4%BD%BF%E7%94%A8insert%E6%A0%87%E7%AD%BE%E7%9A%84%E5%B1%9E%E6%80%A7useGeneratedKeys%EF%BC%8CkeyProperty%EF%BC%8CkeyColumn%E5%AE%9E%E7%8E%B0%EF%BC%9B"><span class="toc-number">1.1.2.2.</span> <span class="toc-text">实现二：使用insert标签的属性useGeneratedKeys，keyProperty，keyColumn实现；</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B0%8F%E7%BB%93"><span class="toc-number">1.1.2.3.</span> <span class="toc-text">小结</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%903%E3%80%91%E5%8D%95%E4%B8%AA%E5%8F%82%E6%95%B0%EF%BC%8C%E5%A4%9A%E4%B8%AA%E5%8F%82%E6%95%B0-%E9%87%8D%E7%82%B9"><span class="toc-number">1.1.3.</span> <span class="toc-text">【3】单个参数，多个参数(重点)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E3%80%90%E5%8D%95%E4%B8%AA%E5%8F%82%E6%95%B0%E3%80%91"><span class="toc-number">1.1.3.1.</span> <span class="toc-text">【单个参数】</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E3%80%90%E6%8E%A5%E5%8F%A3%E4%BC%A0%E5%8F%82%E3%80%91"><span class="toc-number">1.1.3.1.1.</span> <span class="toc-text">【接口传参】</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E3%80%90%E6%8E%A5%E6%94%B6%E5%8F%82%E6%95%B0%E3%80%91"><span class="toc-number">1.1.3.1.2.</span> <span class="toc-text">【接收参数】</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E3%80%90%E7%BB%93%E8%AE%BA%E3%80%91"><span class="toc-number">1.1.3.1.3.</span> <span class="toc-text">【结论】</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E3%80%90%E5%A4%9A%E4%B8%AA%E5%8F%82%E6%95%B0%E3%80%91"><span class="toc-number">1.1.3.2.</span> <span class="toc-text">【多个参数】</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E3%80%90%E6%8E%A5%E5%8F%A3%E4%BC%A0%E5%8F%82%E3%80%91-1"><span class="toc-number">1.1.3.2.1.</span> <span class="toc-text">【接口传参】</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E3%80%90%E6%8E%A5%E6%94%B6%E5%8F%82%E6%95%B0%E3%80%91-1"><span class="toc-number">1.1.3.2.2.</span> <span class="toc-text">【接收参数】</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E3%80%90%E5%B0%8F%E7%BB%93%E3%80%91"><span class="toc-number">1.1.3.2.3.</span> <span class="toc-text">【小结】</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%904%E3%80%91pojo%E5%8F%82%E6%95%B0%E3%80%90%E9%87%8D%E7%82%B9%E3%80%91"><span class="toc-number">1.1.4.</span> <span class="toc-text">【4】pojo参数【重点】</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%905%E3%80%91HashMap%E5%8F%82%E6%95%B0"><span class="toc-number">1.1.5.</span> <span class="toc-text">【5】HashMap参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%906%E3%80%91%E5%85%A5%E5%8F%82%E5%B0%8F%E7%BB%93%EF%BC%9A%E6%8E%A5%E5%8F%A3%E6%96%B9%E6%B3%95%E4%BC%A0%E5%85%A5%E7%9A%84%E5%8F%82%E6%95%B0"><span class="toc-number">1.1.6.</span> <span class="toc-text">【6】入参小结：接口方法传入的参数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2%E3%80%81%E5%8F%82%E6%95%B0%E5%80%BC%E7%9A%84%E8%8E%B7%E5%8F%96"><span class="toc-number">1.2.</span> <span class="toc-text">2、参数值的获取</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%901%E3%80%91-%E5%92%8C-%E5%8F%96%E5%80%BC"><span class="toc-number">1.2.1.</span> <span class="toc-text">【1】#{}和${}取值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%902%E3%80%91-%E5%8F%96%E5%80%BC%E7%9A%84%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">1.2.2.</span> <span class="toc-text">【2】${}取值的应用场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%903%E3%80%91-%E5%8F%96%E5%80%BC%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-number">1.2.3.</span> <span class="toc-text">【3】${}取值注意事项</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E5%B0%8F%E7%BB%93%E3%80%91-1"><span class="toc-number">1.2.4.</span> <span class="toc-text">【小结】</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%A9%E5%B1%95-mysql%E8%87%AA%E5%B8%A6%E5%87%BD%E6%95%B0concat%E6%8B%BC%E6%8E%A5%E4%BD%BF%E7%94%A8"><span class="toc-number">1.2.5.</span> <span class="toc-text">扩展 mysql自带函数concat拼接使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%A5%E5%8F%82%E6%80%BB%E7%BB%93%EF%BC%9A"><span class="toc-number">1.2.6.</span> <span class="toc-text">入参总结：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3%E3%80%81%E7%BB%93%E6%9E%9C%E6%98%A0%E5%B0%84"><span class="toc-number">1.3.</span> <span class="toc-text">3、结果映射</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%901%E3%80%91resultType"><span class="toc-number">1.3.1.</span> <span class="toc-text">【1】resultType</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1%E8%BF%94%E5%9B%9E%E5%80%BC%E6%98%AF%E7%AE%80%E5%8D%95%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.3.1.1.</span> <span class="toc-text">1.1返回值是简单类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2%E8%BF%94%E5%9B%9E%E5%80%BC%E4%B8%BA%E4%B8%80%E4%B8%AApojo-User-%E5%AF%B9%E8%B1%A1%E6%97%B6"><span class="toc-number">1.3.1.2.</span> <span class="toc-text">1.2返回值为一个pojo(User)对象时</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-3%E8%BF%94%E5%9B%9E%E5%80%BC%E4%B8%BA%E4%B8%80%E4%B8%AAList%E6%97%B6"><span class="toc-number">1.3.1.3.</span> <span class="toc-text">1.3返回值为一个List时</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-4%E8%BF%94%E5%9B%9E%E5%80%BC%E4%B8%BAmap"><span class="toc-number">1.3.1.4.</span> <span class="toc-text">1.4返回值为map</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E3%80%901%E3%80%91%E8%BF%94%E5%9B%9E%E4%B8%80%E6%9D%A1%E6%95%B0%E6%8D%AE%EF%BC%8C%E5%B0%81%E8%A3%85%E5%88%B0map%E4%B8%AD"><span class="toc-number">1.3.1.4.1.</span> <span class="toc-text">【1】返回一条数据，封装到map中</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E3%80%902%E3%80%91%E8%BF%94%E5%9B%9E%E5%A4%9A%E6%9D%A1%E6%95%B0%E6%8D%AE%EF%BC%8C%E5%B0%81%E8%A3%85%E5%88%B0map%E4%B8%AD"><span class="toc-number">1.3.1.4.2.</span> <span class="toc-text">【2】返回多条数据，封装到map中</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B0%8F%E7%BB%93-1"><span class="toc-number">1.3.1.5.</span> <span class="toc-text">小结</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%902%E3%80%91resultMap-%E6%8E%8C%E6%8F%A1"><span class="toc-number">1.3.2.</span> <span class="toc-text">【2】resultMap(掌握)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E3%80%90%E9%9C%80%E6%B1%82%E3%80%91"><span class="toc-number">1.3.2.1.</span> <span class="toc-text">【需求】</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E3%80%90%E5%AE%9E%E7%8E%B0%E6%AD%A5%E9%AA%A4%E3%80%91"><span class="toc-number">1.3.2.2.</span> <span class="toc-text">【实现步骤】</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E3%80%90%E5%B0%8F%E7%BB%93%E3%80%91-2"><span class="toc-number">1.3.2.3.</span> <span class="toc-text">【小结】</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4%E3%80%81%E5%8A%A8%E6%80%81SQL"><span class="toc-number">1.4.</span> <span class="toc-text">4、动态SQL</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81if%E6%A0%87%E7%AD%BE"><span class="toc-number">1.4.1.</span> <span class="toc-text">1、if标签</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1%E3%80%81%E5%AE%9A%E4%B9%89%E6%8E%A5%E5%8F%A3%E6%96%B9%E6%B3%95"><span class="toc-number">1.4.1.1.</span> <span class="toc-text">1.1、定义接口方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2%E3%80%81%E7%BC%96%E5%86%99SQL"><span class="toc-number">1.4.1.2.</span> <span class="toc-text">1.2、编写SQL</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-3%E3%80%81%E6%B5%8B%E8%AF%95"><span class="toc-number">1.4.1.3.</span> <span class="toc-text">1.3、测试</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81choose%EF%BC%8Cwhen%EF%BC%8Cotherwise"><span class="toc-number">1.4.2.</span> <span class="toc-text">2、choose，when，otherwise</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1%E3%80%81%E5%AE%9A%E4%B9%89%E6%8E%A5%E5%8F%A3%E6%96%B9%E6%B3%95"><span class="toc-number">1.4.2.1.</span> <span class="toc-text">2.1、定义接口方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2%E3%80%81%E7%BC%96%E5%86%99SQL"><span class="toc-number">1.4.2.2.</span> <span class="toc-text">2.2、编写SQL</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3%E3%80%81%E6%B5%8B%E8%AF%95"><span class="toc-number">1.4.2.3.</span> <span class="toc-text">2.3、测试</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81where"><span class="toc-number">1.4.3.</span> <span class="toc-text">3、where</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1%E3%80%81%E5%AE%9A%E4%B9%89%E6%8E%A5%E5%8F%A3%E6%96%B9%E6%B3%95"><span class="toc-number">1.4.3.1.</span> <span class="toc-text">3.1、定义接口方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2%E3%80%81%E7%BC%96%E5%86%99SQL"><span class="toc-number">1.4.3.2.</span> <span class="toc-text">3.2、编写SQL</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3%E3%80%81%E6%B5%8B%E8%AF%95"><span class="toc-number">1.4.3.3.</span> <span class="toc-text">3.3、测试</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%E3%80%81set"><span class="toc-number">1.4.4.</span> <span class="toc-text">4、set</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-1%E3%80%81%E5%AE%9A%E4%B9%89%E6%8E%A5%E5%8F%A3%E6%96%B9%E6%B3%95"><span class="toc-number">1.4.4.1.</span> <span class="toc-text">4.1、定义接口方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2%E3%80%81%E7%BC%96%E5%86%99SQL"><span class="toc-number">1.4.4.2.</span> <span class="toc-text">4.2、编写SQL</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3%E3%80%81%E6%B5%8B%E8%AF%95"><span class="toc-number">1.4.4.3.</span> <span class="toc-text">4.3、测试</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5%E3%80%81foreach"><span class="toc-number">1.4.5.</span> <span class="toc-text">5、foreach</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-1%E3%80%81%E5%AE%9A%E4%B9%89%E6%8E%A5%E5%8F%A3%E6%96%B9%E6%B3%95"><span class="toc-number">1.4.5.1.</span> <span class="toc-text">5.1、定义接口方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-2%E3%80%81%E7%BC%96%E5%86%99SQL"><span class="toc-number">1.4.5.2.</span> <span class="toc-text">5.2、编写SQL</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-3%E3%80%81%E6%B5%8B%E8%AF%95"><span class="toc-number">1.4.5.3.</span> <span class="toc-text">5.3、测试</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6%E3%80%81%E5%B0%8F%E7%BB%93"><span class="toc-number">1.4.6.</span> <span class="toc-text">6、小结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">1.5.</span> <span class="toc-text">总结</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%AB%98%E7%BA%A7%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.6.</span> <span class="toc-text">高级查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E4%B8%80%E5%AF%B9%E4%B8%80%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.6.1.</span> <span class="toc-text">1、一对一查询</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-number">1.6.1.0.1.</span> <span class="toc-text">注意事项</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E3%80%90%E5%B0%8F%E7%BB%93%E3%80%91-3"><span class="toc-number">1.6.1.0.2.</span> <span class="toc-text">【小结】</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E4%B8%80%E5%AF%B9%E5%A4%9A%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.6.2.</span> <span class="toc-text">2、一对多查询</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E3%80%90%E5%B0%8F%E7%BB%93%E3%80%91-4"><span class="toc-number">1.6.2.0.1.</span> <span class="toc-text">【小结】</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%AB%98%E7%BA%A7%E6%9F%A5%E8%AF%A2%E5%B0%8F%E7%BB%93"><span class="toc-number">1.7.</span> <span class="toc-text">高级查询小结</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/04/20/8e8bf56b.html" title="Oracle 零碎">Oracle 零碎</a><time datetime="2023-04-20T02:37:31.000Z" title="发表于 2023-04-20 10:37:31">2023-04-20</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/03/23/1235b36.html" title="GIT 提交规范">GIT 提交规范</a><time datetime="2023-03-23T08:29:59.000Z" title="发表于 2023-03-23 16:29:59">2023-03-23</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/01/10/72970fee.html" title="Docker 简单学习">Docker 简单学习</a><time datetime="2023-01-10T10:22:57.000Z" title="发表于 2023-01-10 18:22:57">2023-01-10</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/12/16/d61ff02.html" title="Spring Bean学习">Spring Bean学习</a><time datetime="2022-12-16T12:11:12.000Z" title="发表于 2022-12-16 20:11:12">2022-12-16</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/12/14/52dd996.html" title="Java 反射应用">Java 反射应用</a><time datetime="2022-12-14T11:58:12.000Z" title="发表于 2022-12-14 19:58:12">2022-12-14</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;<font color="#58abf3">2022 - 2023  </font><i id="heartbeat" class="fa fas fa-heartbeat"></i>  <font color="#58abf3">Yxliu</font></div><div class="framework-info"><span>框架 </span><a target="_blank" href="https://hexo.io" style="color:#C71585;font-weight: bold;"> Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" href="https://github.com/jerryc127/hexo-theme-butterfly" style="color:#C71585;font-weight: bold;">Butterfly</a></div><div class="framework-info1"> </div><div class="footer_custom_text"><b>Life is a gift, So is Life ,So are you.</b><p><a target="_blank" href="https://hexo.io/"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/icon/Hexo.svg" title="博客框架为Hexo"></a>&nbsp;<a target="_blank" href="https://butterfly.js.org/"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/icon/Theme.svg" title="主题采用butterfly"></a>&nbsp;<a target="_blank" href="https://cloud.tencent.com/"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/icon/tengxun.svg" title="本站使用腾讯云为静态资源提供CDN加速"></a> &nbsp;<a target="_blank" href="https://github.com/"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/icon/Github.svg" title="本站项目由Gtihub托管"></a>&nbsp;<a target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/icon/Copyright.svg" title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"></a></p> <div style="width:600px;margin:0 auto; padding:0px 0;"><a target="_blank" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=41138102000235" style="display:inline-block;text-decoration:none;height:20px;line-height:20px;"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/icp.png" style="float:left;"/><p style="float:left;height:20px;line-height:20px;margin:0px 0px 0px 5px; color:#939393;">豫公网安备 41138102000235号 </p></a>  <a target="_blank" href="https://beian.miit.gov.cn" style="display:inline-block;text-decoration:none;height:20px;line-height:20px;"><p style="float:left;height:20px;line-height:20px;margin:0px 0px 0px 5px; color:#939393;">豫ICP备20013183号</p></a></div></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.1
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        insertScript: [200, () => {
          document.querySelectorAll('mjx-container').forEach(node => {
            if (node.hasAttribute('display')) {
              btf.wrap(node, 'div', { class: 'mathjax-overflow' })
            } else {
              btf.wrap(node, 'span', { class: 'mathjax-overflow' })
            }
          });
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'JBDTtSdxmEkD5K2guGCaGqmI-gzGzoHsz',
      appKey: 'ys0F9864Vdiym7jb41uYLzfk',
      avatar: 'monsterid',
      serverURLs: '',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !false) {
  if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script></div><script async src="https://cdn.jsdelivr.net/gh/gift95/gift95.github.io@master/themes/butterfly/source/js/hideMobileSidebar.js"></script><script async src="https://cdn.jsdelivr.net/gh/gift95/gift95.github.io@master/themes/butterfly/source/js/sakura.js"></script><script async src="https://cdn.jsdelivr.net/gh/gift95/gift95.github.io@master/themes/butterfly/source/js/footer.js"></script><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="false"></script></div><!-- hexo injector body_end start --><script data-pjax src="https://cdn.jsdelivr.net/gh/gift95/hexo-filter-gitcalendar@main/gitcalendar.js"></script><script data-pjax>
  function gitcalendar_injector_config(){
      var parent_div_git = document.getElementById('recent-posts');
      var item_html = '<div class="recent-post-item" id="gitcalendarBar" style="width:100%;height:auto;padding:10px;"><style>#git_container{min-height: 280px}@media screen and (max-width:650px) {#git_container{min-height: 0px}}</style><div id="git_loading" style="width:10%;height:100%;margin:0 auto;display: block;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 50 50" style="enable-background:new 0 0 50 50" xml:space="preserve"><path fill="#d0d0d0" d="M25.251,6.461c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615V6.461z" transform="rotate(275.098 25 25)"><animatetransform attributeType="xml" attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.6s" repeatCount="indefinite"></animatetransform></path></svg><style>#git_container{display: none;}</style></div><div id="git_container"></div></div>';
      parent_div_git.insertAdjacentHTML("afterbegin",item_html)
      console.log('已挂载gitcalendar')
      }

    if( document.getElementById('recent-posts') && (location.pathname ==='/'|| '/' ==='all')){
        gitcalendar_injector_config()
        GitCalendarInit("https://gitcalendar.hnlyx.top/api?gift95",['#ebedf0', '#fdcdec', '#fc9bd9', '#fa6ac5', '#f838b2', '#f5089f', '#c4067e', '#92055e', '#540336', '#48022f', '#30021f'],'gift95')
    }
  </script><!-- hexo injector body_end end --></body></html>